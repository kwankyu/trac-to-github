# Issue 3099: Singular crashes on OSX in 32 bit mode

archive/issues_003099.json:
```json
{
    "body": "Singular crashes at degree 13 on intel core duo machine (mac os 10.5.2) when running \"fano7.sage\" with user command \"run2(1,20)\".  See attached files (fano7.sage, crash.txt}.  You may want to try \"run(12,20)\" to get to the crash more quickly.  Also, \"run2(19,40)\" crashed a quad core ppc machine with 8 gigs of memory.  The crash occurred before there was any significant output.\n\n**Assignee:** mabshoff\n\n**CC:**  PolyBoRi @dimpase\n\n**Reviewer:** Dima Pasechnik\n\nIssue created by migration from https://trac.sagemath.org/ticket/3099\n\n",
    "closed_at": "2020-04-18T12:57:50Z",
    "created_at": "2008-05-03T21:00:46Z",
    "labels": [
        "component: commutative algebra",
        "bug",
        "invalid"
    ],
    "title": "Singular crashes on OSX in 32 bit mode",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/3099",
    "user": "https://trac.sagemath.org/admin/accounts/users/jxxcarlson"
}
```
Singular crashes at degree 13 on intel core duo machine (mac os 10.5.2) when running "fano7.sage" with user command "run2(1,20)".  See attached files (fano7.sage, crash.txt}.  You may want to try "run(12,20)" to get to the crash more quickly.  Also, "run2(19,40)" crashed a quad core ppc machine with 8 gigs of memory.  The crash occurred before there was any significant output.

**Assignee:** mabshoff

**CC:**  PolyBoRi @dimpase

**Reviewer:** Dima Pasechnik

Issue created by migration from https://trac.sagemath.org/ticket/3099





---

archive/issue_comments_017100.json:
```json
{
    "body": "Sage source file",
    "created_at": "2008-05-03T21:01:40Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17100",
    "user": "https://trac.sagemath.org/admin/accounts/users/jxxcarlson"
}
```

Sage source file



---

archive/attachments_003126.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "fano7.sage",
    "asset_url": "tarball://root/attachments/ticket3099/fano7.sage",
    "created_at": "2008-05-03T21:03:16Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket3099/fano7.sage",
    "user": "https://trac.sagemath.org/admin/accounts/users/jxxcarlson"
}
```



---

archive/attachments_003127.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "crash.txt",
    "asset_url": "tarball://root/attachments/ticket3099/crash.txt",
    "created_at": "2008-05-03T21:03:16Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket3099/crash.txt",
    "user": "https://trac.sagemath.org/admin/accounts/users/jxxcarlson"
}
```



---

archive/issue_comments_017101.json:
```json
{
    "body": "**Attachment:** [fano7.sage](https://github.com/sagemath/sage/files/ticket3099/fano7.sage)\n\n**Attachment:** [crash.txt](https://github.com/sagemath/sage/files/ticket3099/crash.txt)\n\nCrash log",
    "created_at": "2008-05-03T21:03:16Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17101",
    "user": "https://trac.sagemath.org/admin/accounts/users/jxxcarlson"
}
```

**Attachment:** [fano7.sage](https://github.com/sagemath/sage/files/ticket3099/fano7.sage)

**Attachment:** [crash.txt](https://github.com/sagemath/sage/files/ticket3099/crash.txt)

Crash log



---

archive/issue_events_016412.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-05-04T03:32:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-3.0.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16412"
}
```



---

archive/issue_comments_017102.json:
```json
{
    "body": "<a id='comment:1'></a>\nHi Jim,\n\nthis looks related to #3098. Since we have a fix for that issue which will be part of 3.0.1 can you try with it and check if the issue has been fixed? William is trying on a similar setup that also shows #3098, so hopefully he can give us some info here, too.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-04T03:32:54Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17102",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:1'></a>
Hi Jim,

this looks related to #3098. Since we have a fix for that issue which will be part of 3.0.1 can you try with it and check if the issue has been fixed? William is trying on a similar setup that also shows #3098, so hopefully he can give us some info here, too.

Cheers,

Michael



---

archive/issue_comments_017103.json:
```json
{
    "body": "<a id='comment:2'></a>\nFYI:\n\n```\nme: ok. I just commented on the ticket that it likely would.\nSo you might want to clue us in that it is not that issue, but a similar problem\n William: Good.\n me: I also think that the \"huge\" problem he posted might just be that he ran out of RAM.\n William: Line 803 in singular.py would be fixed in a similar way to the fix in my other patch.\nWe'll find out in a while.\n me: After all: we are running Singular in 32 bit mode on OSX for now.\nNow if that mabshoff guy got moving on that issue .... [wink]\n William: Yes, what's holding up the 64-bit port?\n me: Nothing. Just spending my \"free\" time with lisp, Itanium and other fun stuff.\n```\n\nThe 64 bit OSX port is a high priority item for us and most problems have been already solved. William and I will likely spend some good time this Sunday and try to get everything merged back into 3.0.2.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-04T04:17:23Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17103",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
FYI:

```
me: ok. I just commented on the ticket that it likely would.
So you might want to clue us in that it is not that issue, but a similar problem
 William: Good.
 me: I also think that the "huge" problem he posted might just be that he ran out of RAM.
 William: Line 803 in singular.py would be fixed in a similar way to the fix in my other patch.
We'll find out in a while.
 me: After all: we are running Singular in 32 bit mode on OSX for now.
Now if that mabshoff guy got moving on that issue .... [wink]
 William: Yes, what's holding up the 64-bit port?
 me: Nothing. Just spending my "free" time with lisp, Itanium and other fun stuff.
```

The 64 bit OSX port is a high priority item for us and most problems have been already solved. William and I will likely spend some good time this Sunday and try to get everything merged back into 3.0.2.

Cheers,

Michael



---

archive/issue_events_016413.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-05-29T01:58:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "rename": {
        "from": "Singular crashes",
        "to": "Singular crashes on OSX in 32 bit mode"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16413"
}
```



---

archive/issue_comments_017104.json:
```json
{
    "body": "<a id='comment:3'></a>\nI had some off list communication with Michael Brickenstein and he recommended using \n\n```\nHi Michael!\n\nI also use\n-with-valloc=system\nadditionally to\n--with-malloc=system\n\non Mac OS X  (32bit). I had issues with Singular not being able to\nallocate much memory (under certain circumstances) a few years ago\nand this configuration has proven to be useful.\n\nBest regards,\nMichael \n```\nI am not sure how Singular normally reacts when running out of memory, but it should obviously never crash.\n\nI am CCing PolyBoRi since Michael B. might enlighten us about this specific problem.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-29T01:58:21Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17104",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:3'></a>
I had some off list communication with Michael Brickenstein and he recommended using 

```
Hi Michael!

I also use
-with-valloc=system
additionally to
--with-malloc=system

on Mac OS X  (32bit). I had issues with Singular not being able to
allocate much memory (under certain circumstances) a few years ago
and this configuration has proven to be useful.

Best regards,
Michael 
```
I am not sure how Singular normally reacts when running out of memory, but it should obviously never crash.

I am CCing PolyBoRi since Michael B. might enlighten us about this specific problem.

Cheers,

Michael



---

archive/issue_comments_017105.json:
```json
{
    "body": "**Changing assignee** from @malb to mabshoff.",
    "created_at": "2008-05-29T01:58:21Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17105",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing assignee** from @malb to mabshoff.



---

archive/issue_comments_017106.json:
```json
{
    "body": "<a id='comment:4'></a>\nusually I got a clear error message about not being able to allocate more virtual memory (sometimes having only 100MB of memory consumed).\nI would recommend to export the actual commands sent to Singular somehow and to reproduce them with the Singular version in fink (and on other platforms).",
    "created_at": "2008-05-29T06:04:38Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17106",
    "user": "https://trac.sagemath.org/admin/accounts/users/PolyBoRi"
}
```

<a id='comment:4'></a>
usually I got a clear error message about not being able to allocate more virtual memory (sometimes having only 100MB of memory consumed).
I would recommend to export the actual commands sent to Singular somehow and to reproduce them with the Singular version in fink (and on other platforms).



---

archive/issue_comments_017107.json:
```json
{
    "body": "<a id='comment:5'></a>\nBy the way: In Singular it is never checked, if an allocation is successful.\nIn this case, it usually crashes...\nIn fact, I was explicitely asked not to check the results of malloc calls...",
    "created_at": "2008-05-29T07:06:45Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17107",
    "user": "https://trac.sagemath.org/admin/accounts/users/PolyBoRi"
}
```

<a id='comment:5'></a>
By the way: In Singular it is never checked, if an allocation is successful.
In this case, it usually crashes...
In fact, I was explicitely asked not to check the results of malloc calls...



---

archive/issue_events_016414.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16414"
}
```



---

archive/issue_events_016415.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16415"
}
```



---

archive/issue_events_016416.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16416"
}
```



---

archive/issue_events_016417.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16417"
}
```



---

archive/issue_events_016418.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16418"
}
```



---

archive/issue_events_016419.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16419"
}
```



---

archive/issue_events_016420.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16420"
}
```



---

archive/issue_events_016421.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16421"
}
```



---

archive/issue_comments_017108.json:
```json
{
    "body": "<a id='comment:10'></a>\nOn a new Mac,\n\n```\ndegree = 13\nTime: CPU 171.29 s, Wall: 171.90 s\n5107 [3, 4, 5, 7, 17, 22, 71, 104, 162, 189]\nTime: CPU 216.02 s, Wall: 218.62 s\n54323 [1, 3, 3, 7, 8, 11, 90, 109, 352]\n----------------------------------------------\n```\nbut this is presumably 64-bit.   It would be useful to know if this is still an issue with much larger input on a generic machine. Or is it so old it's wontfix?",
    "created_at": "2016-08-08T19:21:46Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17108",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
On a new Mac,

```
degree = 13
Time: CPU 171.29 s, Wall: 171.90 s
5107 [3, 4, 5, 7, 17, 22, 71, 104, 162, 189]
Time: CPU 216.02 s, Wall: 218.62 s
54323 [1, 3, 3, 7, 8, 11, 90, 109, 352]
----------------------------------------------
```
but this is presumably 64-bit.   It would be useful to know if this is still an issue with much larger input on a generic machine. Or is it so old it's wontfix?



---

archive/issue_events_016422.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-18T06:49:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16422"
}
```



---

archive/issue_comments_017109.json:
```json
{
    "body": "<a id='comment:11'></a>\nOutdated, should be closed",
    "created_at": "2020-04-18T06:49:14Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17109",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Outdated, should be closed



---

archive/issue_events_016423.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-18T11:09:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16423"
}
```



---

archive/issue_events_016424.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-18T11:09:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16424"
}
```



---

archive/issue_events_016425.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-18T11:09:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16425"
}
```



---

archive/issue_comments_017110.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2020-04-18T11:09:41Z",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3099#issuecomment-17110",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_events_016426.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-04-18T12:57:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16426"
}
```



---

archive/issue_events_016427.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-04-18T12:57:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3099",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3099#event-16427"
}
```
