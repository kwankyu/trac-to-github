# Issue 34932: Improve libnauty spkg-configure

archive/issues_034695.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nto reject underlinked libnauty as reported in https://groups.google.com/g/sage-release/c/QRjzctTlVeU/m/1dzzAor2AQAJ\n\nCC:  @tscrim @antonio-rojas @dimpase @kiwifb\n\nComponent: **build: configure**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34932_\n\n",
    "created_at": "2023-01-23T08:59:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve libnauty spkg-configure",
    "type": "issue",
    "updated_at": "2023-01-29T23:06:23Z",
    "url": "https://github.com/sagemath/sage/issues/34932",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

to reject underlinked libnauty as reported in https://groups.google.com/g/sage-release/c/QRjzctTlVeU/m/1dzzAor2AQAJ

CC:  @tscrim @antonio-rojas @dimpase @kiwifb

Component: **build: configure**

_Issue created by migration from https://trac.sagemath.org/ticket/34932_





---

archive/issue_events_472999.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-23T08:59:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34932#event-472999"
}
```



---

archive/issue_events_473000.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-23T08:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34932#event-473000"
}
```



---

archive/issue_events_473001.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-23T08:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34932#event-473001"
}
```



---

archive/issue_events_473002.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-23T08:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34932#event-473002"
}
```



---

archive/issue_comments_562719.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nShould sage really care about working around distro packaging bugs? It is already complex enough to try to support all possible combinations of different versions of system and bundled packages.",
    "created_at": "2023-01-23T20:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34932#issuecomment-562719",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:2" align="right">comment:2</div>

Should sage really care about working around distro packaging bugs? It is already complex enough to try to support all possible combinations of different versions of system and bundled packages.



---

archive/issue_comments_562720.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFor the record, the issue has been spotted earlier in one of the tickets about giac. It may have been a different guilty distro at the time, I should troll tickets to find the reference.\n\n@antonio-rojas at the very least we should have notes about broken systems and where we can, have someone fill bugs upstream.",
    "created_at": "2023-01-23T20:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34932#issuecomment-562720",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:3" align="right">comment:3</div>

For the record, the issue has been spotted earlier in one of the tickets about giac. It may have been a different guilty distro at the time, I should troll tickets to find the reference.

@antonio-rojas at the very least we should have notes about broken systems and where we can, have someone fill bugs upstream.



---

archive/issue_comments_562721.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOK, we dealt with a very similar issue in #31403 - it was ubuntu 21-?? at the time. So, it is further brokenness in that space, or someone removed stuff put in place by #31403.",
    "created_at": "2023-01-23T20:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34932#issuecomment-562721",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

OK, we dealt with a very similar issue in #31403 - it was ubuntu 21-?? at the time. So, it is further brokenness in that space, or someone removed stuff put in place by #31403.



---

archive/issue_comments_562722.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nA simpler fix than what is described in #31403 as the next step, would be to slightly upgrade `libnauty` from \"optional package\" to \"standard package that is not 'required' unless `giac` or `normaliz` need to be built\".\n\nSame mechanism as in `build/pkgs/openssl/spkg-configure.m4`.",
    "created_at": "2023-01-24T21:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34932#issuecomment-562722",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

A simpler fix than what is described in #31403 as the next step, would be to slightly upgrade `libnauty` from "optional package" to "standard package that is not 'required' unless `giac` or `normaliz` need to be built".

Same mechanism as in `build/pkgs/openssl/spkg-configure.m4`.



---

archive/issue_events_473003.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T23:06:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/34932",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34932#event-473003"
}
```
