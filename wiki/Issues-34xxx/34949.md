# Issue 34949: sage.{categories,matrix,structure}: Replace imports from sage.*.all for namespace packages

archive/issues_034712.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nUsing `./sage -fiximports` from #34945.\n\nAlso remove trailing whitespace in the affected files.\n\nPart of Meta-ticket #32414\n\n\nCC:  @alexchandler100 @tscrim @fchapoton\n\nComponent: **refactoring**\n\nAuthor: **Alex Chandler, Matthias Koeppe**\n\nBranch/Commit: **[u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages) @ [`6203202`](https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34949_\n\n",
    "created_at": "2023-01-29T19:08:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage.{categories,matrix,structure}: Replace imports from sage.*.all for namespace packages",
    "type": "issue",
    "updated_at": "2023-01-30T07:02:51Z",
    "url": "https://github.com/sagemath/sage/issues/34949",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

Using `./sage -fiximports` from #34945.

Also remove trailing whitespace in the affected files.

Part of Meta-ticket #32414


CC:  @alexchandler100 @tscrim @fchapoton

Component: **refactoring**

Author: **Alex Chandler, Matthias Koeppe**

Branch/Commit: **[u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages) @ [`6203202`](https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc)**

_Issue created by migration from https://trac.sagemath.org/ticket/34949_





---

archive/issue_events_473125.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T19:08:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473125"
}
```



---

archive/issue_events_473126.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T19:08:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473126"
}
```



---

archive/issue_events_473127.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T19:08:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473127"
}
```



---

archive/issue_events_473128.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T19:08:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473128"
}
```



---

archive/issue_comments_562877.json:
```json
{
    "body": "Branch: **[u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages)**",
    "created_at": "2023-01-29T19:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562877",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage__categories_matrix_structure___replace_imports_from_sage___all_for_namespace_packages)**



---

archive/issue_comments_562878.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a14d662aec9b9340385f0a92e7de92939e53c10c\"><code>a14d662</code></a></td><td><code>sage -fiximports src/sage/{categories,matrix,structure}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317\"><code>9911481</code></a></td><td><code>src/sage/{categories,matrix,structure}: Manual fixes to imports</code></td></tr></table>\n",
    "created_at": "2023-01-29T19:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562878",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a14d662aec9b9340385f0a92e7de92939e53c10c"><code>a14d662</code></a></td><td><code>sage -fiximports src/sage/{categories,matrix,structure}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317"><code>9911481</code></a></td><td><code>src/sage/{categories,matrix,structure}: Manual fixes to imports</code></td></tr></table>




---

archive/issue_events_473129.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T19:18:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473129"
}
```



---

archive/issue_comments_562879.json:
```json
{
    "body": "Commit: **[`9911481`](https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317)**",
    "created_at": "2023-01-29T19:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562879",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`9911481`](https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317)**



---

archive/issue_events_473130.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T21:54:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473130"
}
```



---

archive/issue_events_473131.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T21:54:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473131"
}
```



---

archive/issue_comments_562880.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n\n```\n[sagelib-9.8.beta7]     Error compiling Cython file:\n[sagelib-9.8.beta7]     ------------------------------------------------------------\n[sagelib-9.8.beta7]     ...\n[sagelib-9.8.beta7]             if not isinstance(right, Element):\n[sagelib-9.8.beta7]                 right = py_scalar_to_element(right)\n[sagelib-9.8.beta7]                 if not isinstance(right, Element):\n[sagelib-9.8.beta7]                     right = right.sage()\n[sagelib-9.8.beta7]             from sage.arith.misc import GCD as gcd\n[sagelib-9.8.beta7]                 from sage.arith.misc import GCD as gcd\n[sagelib-9.8.beta7]     ^\n[sagelib-9.8.beta7]     ------------------------------------------------------------\n[sagelib-9.8.beta7] \n[sagelib-9.8.beta7]     sage/structure/element.pyx:4057:0: Possible inconsistent indentation\n[sagelib-9.8.beta7] \n[sagelib-9.8.beta7]     Error compiling Cython file:\n[sagelib-9.8.beta7]     ------------------------------------------------------------\n[sagelib-9.8.beta7]     ...\n[sagelib-9.8.beta7]             if not isinstance(right, Element):\n[sagelib-9.8.beta7]                 right = py_scalar_to_element(right)\n[sagelib-9.8.beta7]                 if not isinstance(right, Element):\n[sagelib-9.8.beta7]                     right = right.sage()\n[sagelib-9.8.beta7]             from sage.arith.misc import GCD as gcd\n[sagelib-9.8.beta7]                 from sage.arith.misc import GCD as gcd\n[sagelib-9.8.beta7]     ^\n[sagelib-9.8.beta7]     ------------------------------------------------------------\n[sagelib-9.8.beta7] \n[sagelib-9.8.beta7]     sage/structure/element.pyx:4057:0: Expected an identifier or literal\n```",
    "created_at": "2023-01-29T21:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562880",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>


```
[sagelib-9.8.beta7]     Error compiling Cython file:
[sagelib-9.8.beta7]     ------------------------------------------------------------
[sagelib-9.8.beta7]     ...
[sagelib-9.8.beta7]             if not isinstance(right, Element):
[sagelib-9.8.beta7]                 right = py_scalar_to_element(right)
[sagelib-9.8.beta7]                 if not isinstance(right, Element):
[sagelib-9.8.beta7]                     right = right.sage()
[sagelib-9.8.beta7]             from sage.arith.misc import GCD as gcd
[sagelib-9.8.beta7]                 from sage.arith.misc import GCD as gcd
[sagelib-9.8.beta7]     ^
[sagelib-9.8.beta7]     ------------------------------------------------------------
[sagelib-9.8.beta7] 
[sagelib-9.8.beta7]     sage/structure/element.pyx:4057:0: Possible inconsistent indentation
[sagelib-9.8.beta7] 
[sagelib-9.8.beta7]     Error compiling Cython file:
[sagelib-9.8.beta7]     ------------------------------------------------------------
[sagelib-9.8.beta7]     ...
[sagelib-9.8.beta7]             if not isinstance(right, Element):
[sagelib-9.8.beta7]                 right = py_scalar_to_element(right)
[sagelib-9.8.beta7]                 if not isinstance(right, Element):
[sagelib-9.8.beta7]                     right = right.sage()
[sagelib-9.8.beta7]             from sage.arith.misc import GCD as gcd
[sagelib-9.8.beta7]                 from sage.arith.misc import GCD as gcd
[sagelib-9.8.beta7]     ^
[sagelib-9.8.beta7]     ------------------------------------------------------------
[sagelib-9.8.beta7] 
[sagelib-9.8.beta7]     sage/structure/element.pyx:4057:0: Expected an identifier or literal
```



---

archive/issue_comments_562881.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI think these changes are to blame:\n\n```diff\ndiff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx\nindex e9430f0..92e83bd 100644\n--- a/src/sage/structure/element.pyx\n+++ b/src/sage/structure/element.pyx\n@@ -4047,8 +4053,8 @@ cdef class PrincipalIdealDomainElement(DedekindDomainElement):\n             right = py_scalar_to_element(right)\n             if not isinstance(right, Element):\n                 right = right.sage()\n-        if not ((<Element>right)._parent is self._parent):\n-            from sage.arith.all import gcd\n+        from sage.arith.misc import GCD as gcd\n+            from sage.arith.misc import GCD as gcd\n             return coercion_model.bin_op(self, right, gcd)\n         return self._gcd(right)\n \n@@ -4081,8 +4087,8 @@ cdef class PrincipalIdealDomainElement(DedekindDomainElement):\n             right = py_scalar_to_element(right)\n             if not isinstance(right, Element):\n                 right = right.sage()\n-        if not ((<Element>right)._parent is self._parent):\n-            from sage.arith.all import lcm\n+        from sage.arith.functions import lcm\n+            from sage.arith.functions import lcm\n             return coercion_model.bin_op(self, right, lcm)\n         return self._lcm(right)\n```",
    "created_at": "2023-01-29T21:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562881",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

I think these changes are to blame:

```diff
diff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx
index e9430f0..92e83bd 100644
--- a/src/sage/structure/element.pyx
+++ b/src/sage/structure/element.pyx
@@ -4047,8 +4053,8 @@ cdef class PrincipalIdealDomainElement(DedekindDomainElement):
             right = py_scalar_to_element(right)
             if not isinstance(right, Element):
                 right = right.sage()
-        if not ((<Element>right)._parent is self._parent):
-            from sage.arith.all import gcd
+        from sage.arith.misc import GCD as gcd
+            from sage.arith.misc import GCD as gcd
             return coercion_model.bin_op(self, right, gcd)
         return self._gcd(right)
 
@@ -4081,8 +4087,8 @@ cdef class PrincipalIdealDomainElement(DedekindDomainElement):
             right = py_scalar_to_element(right)
             if not isinstance(right, Element):
                 right = right.sage()
-        if not ((<Element>right)._parent is self._parent):
-            from sage.arith.all import lcm
+        from sage.arith.functions import lcm
+            from sage.arith.functions import lcm
             return coercion_model.bin_op(self, right, lcm)
         return self._lcm(right)
```



---

archive/issue_events_473132.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T22:59:31Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473132"
}
```



---

archive/issue_events_473133.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T22:59:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473133"
}
```



---

archive/issue_comments_562882.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f\"><code>01cded9</code></a></td><td><code>src/sage/structure/element.pyx: Fix up</code></td></tr></table>\n",
    "created_at": "2023-01-30T00:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562882",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f"><code>01cded9</code></a></td><td><code>src/sage/structure/element.pyx: Fix up</code></td></tr></table>




---

archive/issue_comments_562883.json:
```json
{
    "body": "Changed commit from **[`9911481`](https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317)** to **[`01cded9`](https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f)**",
    "created_at": "2023-01-30T00:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9911481`](https://github.com/sagemath/sagetrac-mirror/commit/9911481804b7b9fac03695d9d74126a0410c7317)** to **[`01cded9`](https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f)**



---

archive/issue_comments_562884.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThanks, fixed.",
    "created_at": "2023-01-30T00:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562884",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Thanks, fixed.



---

archive/issue_events_473134.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-30T00:38:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473134"
}
```



---

archive/issue_events_473135.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-30T00:38:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34949#event-473135"
}
```



---

archive/issue_comments_562885.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc\"><code>6203202</code></a></td><td><code>sage.matrix: Consolidate imports from the same module</code></td></tr></table>\n",
    "created_at": "2023-01-30T02:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562885",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc"><code>6203202</code></a></td><td><code>sage.matrix: Consolidate imports from the same module</code></td></tr></table>




---

archive/issue_comments_562886.json:
```json
{
    "body": "Changed commit from **[`01cded9`](https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f)** to **[`6203202`](https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc)**",
    "created_at": "2023-01-30T02:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562886",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`01cded9`](https://github.com/sagemath/sagetrac-mirror/commit/01cded97cb2a4cdbfef84f369a6217d8917edc8f)** to **[`6203202`](https://github.com/sagemath/sagetrac-mirror/commit/62032020ad6f73df11cdce1dbeec51aee35ed7cc)**



---

archive/issue_comments_562887.json:
```json
{
    "body": "Changed author from **Alex Chandler** to **Alex Chandler, Matthias Koeppe**",
    "created_at": "2023-01-30T02:33:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34949",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34949#issuecomment-562887",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Alex Chandler** to **Alex Chandler, Matthias Koeppe**
