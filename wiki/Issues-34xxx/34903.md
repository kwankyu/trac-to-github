# Issue 34903: tox.ini / GH Actions: Update Linux platforms

archive/issues_034666.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n`ubuntu-lunar` https://hub.docker.com/_/ubuntu\n\n`fedora-38` (rawhide) https://hub.docker.com/_/fedora\n\n`linuxmint-21.1` https://hub.docker.com/u/linuxmintd\n\n\nDepends on #34849\n\nCC:  @dimpase\n\nComponent: **porting**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34903_\n\n",
    "closed_at": "2023-01-29T11:03:30Z",
    "created_at": "2023-01-09T21:11:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "tox.ini / GH Actions: Update Linux platforms",
    "type": "issue",
    "updated_at": "2023-01-29T11:03:30Z",
    "url": "https://github.com/sagemath/sage/issues/34903",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

`ubuntu-lunar` https://hub.docker.com/_/ubuntu

`fedora-38` (rawhide) https://hub.docker.com/_/fedora

`linuxmint-21.1` https://hub.docker.com/u/linuxmintd


Depends on #34849

CC:  @dimpase

Component: **porting**

Author: **Matthias Koeppe**

Branch/Commit: **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/34903_





---

archive/issue_events_472776.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-09T21:11:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472776"
}
```



---

archive/issue_events_472777.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-09T21:11:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "0000b0",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472777"
}
```



---

archive/issue_events_472778.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-09T21:11:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472778"
}
```



---

archive/issue_events_472779.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-09T21:11:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472779"
}
```



---

archive/issue_comments_562483.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2023-01-13T10:20:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562483",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_562484.json:
```json
{
    "body": "Dependencies: **#34849**",
    "created_at": "2023-01-13T10:20:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562484",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#34849**



---

archive/issue_comments_562485.json:
```json
{
    "body": "Branch: **[u/mkoeppe/tox_ini___gh_actions__update_linux_platforms](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini___gh_actions__update_linux_platforms)**",
    "created_at": "2023-01-13T10:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562485",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/tox_ini___gh_actions__update_linux_platforms](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini___gh_actions__update_linux_platforms)**



---

archive/issue_comments_562486.json:
```json
{
    "body": "Commit: **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**",
    "created_at": "2023-01-13T10:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562486",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**



---

archive/issue_events_472780.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-13T10:22:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472780"
}
```



---

archive/issue_comments_562487.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/449b56bc56bb24a8aa958317463757c6feedf90c\"><code>449b56b</code></a></td><td><code>pkgs/sagemath*/tox.ini: Fix for tox 4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a27a3d089dff6f50dde00a68d896e28fed9a9c8\"><code>4a27a3d</code></a></td><td><code>Merge #34839</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95fe89ab0635531f4626a5711343fb47da280374\"><code>95fe89a</code></a></td><td><code>build/pkgs/tox/spkg-configure.m4: Check for good tox 3, tox 4 versions separately</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc7196abb897a2b3d5bb939e800131b77322dd38\"><code>cc7196a</code></a></td><td><code>src/tox.ini: More allowlist_externals for tox 4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1999bd6f42480d570deb10f85d6d4219c2936af4\"><code>1999bd6</code></a></td><td><code>src/tox.ini: Quoting fix for tox 4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/071c113fe6f7d4405b4f470c6f3ff02eb8359e3d\"><code>071c113</code></a></td><td><code>Merge tag '9.8.beta6' into t/34849/more_fixes_to_support_tox_4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b8c666119fd96115b4efafc3b23984fdacf0f6b\"><code>6b8c666</code></a></td><td><code>Merge #34839</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2eb816f4f265d30e5f9e8b3721ee4c703a29e9b\"><code>a2eb816</code></a></td><td><code>tox.ini: Require tox >= 4.2.7</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fba75012c8b725b599cd34f619e4bb66ee4d36f9\"><code>fba7501</code></a></td><td><code>Merge #34849</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07\"><code>474afe2</code></a></td><td><code>.github/workflows/docker.yml: Add ubuntu-lunar, fedora-38, linuxmint-21.1</code></td></tr></table>\n",
    "created_at": "2023-01-13T10:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562487",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3"></div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/449b56bc56bb24a8aa958317463757c6feedf90c"><code>449b56b</code></a></td><td><code>pkgs/sagemath*/tox.ini: Fix for tox 4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a27a3d089dff6f50dde00a68d896e28fed9a9c8"><code>4a27a3d</code></a></td><td><code>Merge #34839</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95fe89ab0635531f4626a5711343fb47da280374"><code>95fe89a</code></a></td><td><code>build/pkgs/tox/spkg-configure.m4: Check for good tox 3, tox 4 versions separately</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc7196abb897a2b3d5bb939e800131b77322dd38"><code>cc7196a</code></a></td><td><code>src/tox.ini: More allowlist_externals for tox 4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1999bd6f42480d570deb10f85d6d4219c2936af4"><code>1999bd6</code></a></td><td><code>src/tox.ini: Quoting fix for tox 4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/071c113fe6f7d4405b4f470c6f3ff02eb8359e3d"><code>071c113</code></a></td><td><code>Merge tag '9.8.beta6' into t/34849/more_fixes_to_support_tox_4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b8c666119fd96115b4efafc3b23984fdacf0f6b"><code>6b8c666</code></a></td><td><code>Merge #34839</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2eb816f4f265d30e5f9e8b3721ee4c703a29e9b"><code>a2eb816</code></a></td><td><code>tox.ini: Require tox >= 4.2.7</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fba75012c8b725b599cd34f619e4bb66ee4d36f9"><code>fba7501</code></a></td><td><code>Merge #34849</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07"><code>474afe2</code></a></td><td><code>.github/workflows/docker.yml: Add ubuntu-lunar, fedora-38, linuxmint-21.1</code></td></tr></table>




---

archive/issue_comments_562488.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n`tox -e docker-debian-buster-i386-standard-incremental -- build ptest` (latest tox 4, \nthis branch and #34537) fails, and I can't find logs.\nWhere are all these\n\n```\n[graphs-20210214.p0] installing. Log file: /sage/logs/pkgs/graphs-20210214.p0.log\n```\netc, going?",
    "created_at": "2023-01-18T22:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562488",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

`tox -e docker-debian-buster-i386-standard-incremental -- build ptest` (latest tox 4, 
this branch and #34537) fails, and I can't find logs.
Where are all these

```
[graphs-20210214.p0] installing. Log file: /sage/logs/pkgs/graphs-20210214.p0.log
```
etc, going?



---

archive/issue_comments_562489.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt should tell you the sha of a Docker image with the failing build.\nYou can then inspect the image by starting a container (`docker run -it SHA... bash`)",
    "created_at": "2023-01-19T01:09:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562489",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

It should tell you the sha of a Docker image with the failing build.
You can then inspect the image by starting a container (`docker run -it SHA... bash`)



---

archive/issue_comments_562490.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n`cat .tox/docker-debian-buster-i386-standard-incremental/Dockertags` will tell you the images that have been created.",
    "created_at": "2023-01-19T01:10:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562490",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

`cat .tox/docker-debian-buster-i386-standard-incremental/Dockertags` will tell you the images that have been created.



---

archive/issue_comments_562491.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAnd what does this info should tell me?\n\n```\n$ cat .tox/docker-debian-buster-i386-standard-incremental/Dockertags\nsage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed\nsage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed\nsage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed\nsage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed\n$ cat .tox/docker-debian-buster-i386-standard/Dockertags\nsage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed\n```\n\nI tried \"mounting\" these with docker, to no avail.\nIt starts building, and errors out just the same (and nothing is mounted afterwards)",
    "created_at": "2023-01-19T14:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562491",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

And what does this info should tell me?

```
$ cat .tox/docker-debian-buster-i386-standard-incremental/Dockertags
sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed
sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed
sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed
sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed
$ cat .tox/docker-debian-buster-i386-standard/Dockertags
sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed
```

I tried "mounting" these with docker, to no avail.
It starts building, and errors out just the same (and nothing is mounted afterwards)



---

archive/issue_comments_562492.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nUse `docker run -it sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed bash`\n\nIf you don't provide the interpreter (bash), it will just continue with the build recipe",
    "created_at": "2023-01-19T19:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562492",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Use `docker run -it sage-docker-debian-buster-i386-standard-with-targets:9.5.beta0-13242-gd4f48b5f00a-failed bash`

If you don't provide the interpreter (bash), it will just continue with the build recipe



---

archive/issue_events_472781.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2023-01-20T19:24:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472781"
}
```



---

archive/issue_events_472782.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2023-01-20T19:24:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472782"
}
```



---

archive/issue_comments_562493.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOK, lgtm",
    "created_at": "2023-01-20T19:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562493",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

OK, lgtm



---

archive/issue_comments_562494.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2023-01-20T19:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562494",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_562495.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThanks!",
    "created_at": "2023-01-20T20:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562495",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Thanks!



---

archive/issue_events_472783.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2023-01-29T11:03:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472783"
}
```



---

archive/issue_events_472784.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0bf8cd2b73cf48e71f49c5f8050f4a306a724265",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2023-01-29T11:03:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34903#event-472784"
}
```



---

archive/issue_comments_562496.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/tox_ini___gh_actions__update_linux_platforms](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini___gh_actions__update_linux_platforms)** to **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**",
    "created_at": "2023-01-29T11:03:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34903",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34903#issuecomment-562496",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/tox_ini___gh_actions__update_linux_platforms](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini___gh_actions__update_linux_platforms)** to **[`474afe2`](https://github.com/sagemath/sagetrac-mirror/commit/474afe20fa232a36f3d19c3b698c7767d8521e07)**
