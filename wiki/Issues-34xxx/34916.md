# Issue 34916: Integer class should not be register as a “virtual subclass” of the metaclass numbers.Integral

archive/issues_034679.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThe `Integer` class should not be register as a \u201cvirtual subclass\u201d of the metaclass `numbers.Integral` (it is done in line 7671 of `src/sage/rings/integer.pyx` for Sage 9.7).\n\n```python\n# Support Python's numbers abstract base class\nimport numbers\nnumbers.Integral.register(Integer)\n```\n\nThe reason is that the `Integer` class does not adhere to the requirements of the metaclass `numbers.Integral` in **at least** one way: `denominator` and `numerator` are method (so callable) instead of attributes (so non callable).\n\nFor example, it breaks the usage of the python module `fractions` inside of Sage:\n\n```python\nimport fractions\nfractions.Fraction (1, 2)\n```\nWith Sage 9.7 using Python 3.10.5, it raises an exception:\n\n```\nTypeError: unsupported operand type(s) for *: 'builtin_function_or_method' and 'builtin_function_or_method'\n```\nIt is due to the fact that the code inside the `Fraction` class, after testing that the input are subclasses of `numbers.Rational` (which is true for Sage `Integer` because the class is register as a `numbers.Integral`), the code tries to use the attributes `.numerator` which is a callable for Sage `Integer`.\n\nComponent: **basic arithmetic**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34916_\n\n",
    "created_at": "2023-01-17T13:42:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Integer class should not be register as a \u201cvirtual subclass\u201d of the metaclass numbers.Integral",
    "type": "issue",
    "updated_at": "2023-01-17T21:03:50Z",
    "url": "https://github.com/sagemath/sage/issues/34916",
    "user": "https://github.com/sagetrac-bouvier"
}
```
<div id="comment:0"></div>

The `Integer` class should not be register as a “virtual subclass” of the metaclass `numbers.Integral` (it is done in line 7671 of `src/sage/rings/integer.pyx` for Sage 9.7).

```python
# Support Python's numbers abstract base class
import numbers
numbers.Integral.register(Integer)
```

The reason is that the `Integer` class does not adhere to the requirements of the metaclass `numbers.Integral` in **at least** one way: `denominator` and `numerator` are method (so callable) instead of attributes (so non callable).

For example, it breaks the usage of the python module `fractions` inside of Sage:

```python
import fractions
fractions.Fraction (1, 2)
```
With Sage 9.7 using Python 3.10.5, it raises an exception:

```
TypeError: unsupported operand type(s) for *: 'builtin_function_or_method' and 'builtin_function_or_method'
```
It is due to the fact that the code inside the `Fraction` class, after testing that the input are subclasses of `numbers.Rational` (which is true for Sage `Integer` because the class is register as a `numbers.Integral`), the code tries to use the attributes `.numerator` which is a callable for Sage `Integer`.

Component: **basic arithmetic**

_Issue created by migration from https://trac.sagemath.org/ticket/34916_





---

archive/issue_events_472884.json:
```json
{
    "actor": "https://github.com/sagetrac-bouvier",
    "created_at": "2023-01-17T13:42:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472884"
}
```



---

archive/issue_events_472885.json:
```json
{
    "actor": "https://github.com/sagetrac-bouvier",
    "created_at": "2023-01-17T13:42:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472885"
}
```



---

archive/issue_events_472886.json:
```json
{
    "actor": "https://github.com/sagetrac-bouvier",
    "created_at": "2023-01-17T13:42:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472886"
}
```



---

archive/issue_events_472887.json:
```json
{
    "actor": "https://github.com/sagetrac-bouvier",
    "created_at": "2023-01-17T13:42:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472887"
}
```



---

archive/issue_comments_562623.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\ndup of #28234",
    "created_at": "2023-01-17T21:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34916#issuecomment-562623",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

dup of #28234



---

archive/issue_events_472888.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-17T21:03:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472888"
}
```



---

archive/issue_events_472889.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-17T21:03:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/34916",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34916#event-472889"
}
```
