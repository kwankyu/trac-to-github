# Issue 7976: Extends __classcall__ to control inheritance

archive/issues_007976.json:
```json
{
    "body": "This patch extends `ClasscallMetaclass` so that one can control the call of a class trough two different static methods:\n\n- `__classcall__` which behaves as usual and is inherited\n- `__classcall_private__` which is not called by derived classes\n\nIf both exists the later is used.\n\nBy the way it does some polishing of the code.\n\n**Assignee:** @hivert\n\n**CC:**  sage-combinat\n\n**Keywords:** ClassCall, inheritance\n\n**Author:** Florent Hivert\n\n**Reviewer:** Nicolas M. Thi\u00e9ry\n\n**Merged:** sage-4.3.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7976\n\n",
    "closed_at": "2010-01-22T23:27:17Z",
    "created_at": "2010-01-18T13:03:46Z",
    "labels": [
        "component: categories",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.2",
    "title": "Extends __classcall__ to control inheritance",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/7976",
    "user": "https://github.com/hivert"
}
```
This patch extends `ClasscallMetaclass` so that one can control the call of a class trough two different static methods:

- `__classcall__` which behaves as usual and is inherited
- `__classcall_private__` which is not called by derived classes

If both exists the later is used.

By the way it does some polishing of the code.

**Assignee:** @hivert

**CC:**  sage-combinat

**Keywords:** ClassCall, inheritance

**Author:** Florent Hivert

**Reviewer:** Nicolas M. Thiéry

**Merged:** sage-4.3.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7976





---

archive/issue_events_055649.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-01-18T15:08:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55649"
}
```



---

archive/issue_comments_062659.json:
```json
{
    "body": "<a id='comment:2'></a>\nThanks Florent, and thanks for using this occasion to cleanup my code!\n\nCan you fix the copyright dates? Mine should be 2009, and yours 2010\n\nI like the idea of using Python's standard convention for private attributes; on the other hand, I am a bit worried about emulating Python's mechanism. In particular, we could eventually get in trouble with the class name hacking we do for pickling:\n\n```\n   sage: Sets.ParentMethods.__name__\n   'Sets.ParentMethods'\n```\nI haven't found a way to *use* Python mechanism. So instead, what about using ``__classcall_private__``, and doing the test with '__classcall_private__' in cls.__dict__?\n\n(I also prefer ``private`` to ``no_inherit``).\n\nCheers,",
    "created_at": "2010-01-18T22:06:36Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62659",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:2'></a>
Thanks Florent, and thanks for using this occasion to cleanup my code!

Can you fix the copyright dates? Mine should be 2009, and yours 2010

I like the idea of using Python's standard convention for private attributes; on the other hand, I am a bit worried about emulating Python's mechanism. In particular, we could eventually get in trouble with the class name hacking we do for pickling:

```
   sage: Sets.ParentMethods.__name__
   'Sets.ParentMethods'
```
I haven't found a way to *use* Python mechanism. So instead, what about using ``__classcall_private__``, and doing the test with '__classcall_private__' in cls.__dict__?

(I also prefer ``private`` to ``no_inherit``).

Cheers,



---

archive/issue_comments_062660.json:
```json
{
    "body": "**Reviewer:** Nicolas M. Thi\u00e9ry",
    "created_at": "2010-01-18T22:06:36Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62660",
    "user": "https://github.com/nthiery"
}
```

**Reviewer:** Nicolas M. Thiéry



---

archive/issue_comments_062661.json:
```json
{
    "body": "**Changing keywords** from \"ClassCall inheritance\" to \"ClassCall, inheritance\".",
    "created_at": "2010-01-18T22:06:36Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62661",
    "user": "https://github.com/nthiery"
}
```

**Changing keywords** from "ClassCall inheritance" to "ClassCall, inheritance".



---

archive/issue_events_055650.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2010-01-18T22:06:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55650"
}
```



---

archive/issue_events_055651.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2010-01-18T22:06:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55651"
}
```



---

archive/issue_events_055652.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-01-19T05:11:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55652"
}
```



---

archive/issue_events_055653.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-01-19T05:11:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55653"
}
```



---

archive/issue_comments_062662.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [@nthiery](#comment%3A2):\n> Thanks Florent, and thanks for using this occasion to cleanup my code!\n> \n> Can you fix the copyright dates? Mine should be 2009, and yours 2010\n> \n> [...]\n> So instead, what about using ``__classcall_private__``, and doing the test with '__classcall_private__' in cls.__dict__?\n> \n> (I also prefer ``private`` to ``no_inherit``).\n\nI just uploaded a new patch which addresses all these remarks... Please re-review.",
    "created_at": "2010-01-19T05:11:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62662",
    "user": "https://github.com/hivert"
}
```

<a id='comment:3'></a>
Replying to [@nthiery](#comment%3A2):
> Thanks Florent, and thanks for using this occasion to cleanup my code!
> 
> Can you fix the copyright dates? Mine should be 2009, and yours 2010
> 
> [...]
> So instead, what about using ``__classcall_private__``, and doing the test with '__classcall_private__' in cls.__dict__?
> 
> (I also prefer ``private`` to ``no_inherit``).

I just uploaded a new patch which addresses all these remarks... Please re-review.



---

archive/attachments_010175.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7976-classcall_no_inherits-review-nt.patch",
    "asset_url": "tarball://root/attachments/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch",
    "created_at": "2010-01-19T09:05:06Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch",
    "user": "https://github.com/nthiery"
}
```



---

archive/issue_comments_062663.json:
```json
{
    "body": "**Attachment:** [trac_7976-classcall_no_inherits-review-nt.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch)",
    "created_at": "2010-01-19T09:05:06Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62663",
    "user": "https://github.com/nthiery"
}
```

**Attachment:** [trac_7976-classcall_no_inherits-review-nt.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch)



---

archive/issue_comments_062664.json:
```json
{
    "body": "<a id='comment:4'></a>\nPlease double check the quick review patch, and add '#7976:' in front of the patch description, and it's good to go!",
    "created_at": "2010-01-19T09:07:55Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62664",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>
Please double check the quick review patch, and add '#7976:' in front of the patch description, and it's good to go!



---

archive/issue_comments_062665.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n This patch extends `ClasscallMetaclass` so that one can control the call of a class trough two different static methods:\n \n-- `__classcall__` which behave as usual and is inherited\n-- `__classcall__no_inherits` which is not called by derived classes\n+- `__classcall__` which behaves as usual and is inherited\n+- `__classcall_private__` which is not called by derived classes\n \n-If both exists the latter is used.\n+If both exists the later is used.\n+\n+By the way it does some polishing of the code.\n``````\n",
    "created_at": "2010-01-19T09:07:55Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62665",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
 This patch extends `ClasscallMetaclass` so that one can control the call of a class trough two different static methods:
 
-- `__classcall__` which behave as usual and is inherited
-- `__classcall__no_inherits` which is not called by derived classes
+- `__classcall__` which behaves as usual and is inherited
+- `__classcall_private__` which is not called by derived classes
 
-If both exists the latter is used.
+If both exists the later is used.
+
+By the way it does some polishing of the code.
``````




---

archive/issue_events_055654.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2010-01-19T09:07:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "milestone": "sage-4.3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55654"
}
```



---

archive/issue_events_055655.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-01-19T11:50:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55655"
}
```



---

archive/issue_events_055656.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-01-19T11:50:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55656"
}
```



---

archive/attachments_010176.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7976-classcall_no_inherits-fh.patch",
    "asset_url": "tarball://root/attachments/ticket7976/trac_7976-classcall_no_inherits-fh.patch",
    "created_at": "2010-01-19T11:50:38Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-fh.patch",
    "user": "https://github.com/hivert"
}
```



---

archive/issue_comments_062666.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Attachment:** [trac_7976-classcall_no_inherits-fh.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-fh.patch)\n\nReplying to [@nthiery](#comment%3A4):\n> Please double check the quick review patch, and add '#7976:' in front of the patch description, and it's good to go!\n\nI added '#7976:' and re-uploaded the patch. Thanks for the improvement of the doc. Your review patch is ok => positive review.",
    "created_at": "2010-01-19T11:50:38Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62666",
    "user": "https://github.com/hivert"
}
```

<a id='comment:5'></a>
**Attachment:** [trac_7976-classcall_no_inherits-fh.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-fh.patch)

Replying to [@nthiery](#comment%3A4):
> Please double check the quick review patch, and add '#7976:' in front of the patch description, and it's good to go!

I added '#7976:' and re-uploaded the patch. Thanks for the improvement of the doc. Your review patch is ok => positive review.



---

archive/issue_events_055657.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-22T23:27:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55657"
}
```



---

archive/issue_events_055658.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-22T23:27:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7976#event-55658"
}
```



---

archive/issue_comments_062667.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged in this order:\n\n1. [trac_7976-classcall_no_inherits-fh.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-fh.patch)\n2. [trac_7976-classcall_no_inherits-review-nt.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch)",
    "created_at": "2010-01-22T23:27:17Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62667",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:6'></a>
Merged in this order:

1. [trac_7976-classcall_no_inherits-fh.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-fh.patch)
2. [trac_7976-classcall_no_inherits-review-nt.patch](https://github.com/sagemath/sage/files/ticket7976/trac_7976-classcall_no_inherits-review-nt.patch)



---

archive/issue_comments_062668.json:
```json
{
    "body": "**Merged:** sage-4.3.2.alpha0",
    "created_at": "2010-01-22T23:27:17Z",
    "issue": "https://github.com/sagemath/sage/issues/7976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7976#issuecomment-62668",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** sage-4.3.2.alpha0
