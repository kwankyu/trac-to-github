# Issue 21161: repr of NumberFields (the parents) should indicate its embedding if there is one

archive/issues_020924.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nAs discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n\n```\nsage: K.<a> = NumberField(x^2 - 2)\nsage: a.parent()\nNumber Field in a with defining polynomial x^2 - 2\nsage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)\nsage: sqrt2.parent()\nNumber Field in sqrt2 with defining polynomial x^2 - 2\n```\n\nThis ticket changes the print representation when there is an embedding as follows.\n\n```\nNumber Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n```\nThis also works well for more complicated situations such as this one:\n\n```\n            sage: K.<a> = NumberField(x^4 - 3); K\n            Number Field in a with defining polynomial x^4 - 3\n            sage: H.<b>, from_H = K.subfield(a^2)\n            sage: H\n            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n```\n\n\nCC:  @videlec @jplab @JohnCremona @tscrim @mezzarobba @jdemeyer\n\nComponent: **number fields**\n\nAuthor: **Matthias Koeppe**\n\nBranch: **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**\n\nReviewer: **Jean-Philippe Labb\u00e9**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21161_\n\n",
    "closed_at": "2019-05-28T21:07:55Z",
    "created_at": "2016-08-03T23:12:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "repr of NumberFields (the parents) should indicate its embedding if there is one",
    "type": "issue",
    "updated_at": "2019-06-21T12:08:49Z",
    "url": "https://github.com/sagemath/sage/issues/21161",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:

```
sage: K.<a> = NumberField(x^2 - 2)
sage: a.parent()
Number Field in a with defining polynomial x^2 - 2
sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)
sage: sqrt2.parent()
Number Field in sqrt2 with defining polynomial x^2 - 2
```

This ticket changes the print representation when there is an embedding as follows.

```
Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
```
This also works well for more complicated situations such as this one:

```
            sage: K.<a> = NumberField(x^4 - 3); K
            Number Field in a with defining polynomial x^4 - 3
            sage: H.<b>, from_H = K.subfield(a^2)
            sage: H
            Number Field in b with defining polynomial x^2 - 3 with b = a^2
```


CC:  @videlec @jplab @JohnCremona @tscrim @mezzarobba @jdemeyer

Component: **number fields**

Author: **Matthias Koeppe**

Branch: **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**

Reviewer: **Jean-Philippe Labbé**

_Issue created by migration from https://trac.sagemath.org/ticket/21161_





---

archive/issue_events_294987.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-03T23:12:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294987"
}
```



---

archive/issue_events_294988.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-03T23:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294988"
}
```



---

archive/issue_events_294989.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-03T23:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294989"
}
```



---

archive/issue_events_294990.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-03T23:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294990"
}
```



---

archive/issue_comments_308374.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n+As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n \n ```\n sage: K.<a> = NumberField(x^2 - 2)\n``````\n",
    "created_at": "2016-08-03T23:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308374",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:
+As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:
 
 ```
 sage: K.<a> = NumberField(x^2 - 2)
``````




---

archive/issue_comments_308375.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nShorter sentence would be better.\n\n```\nReal Number Field in sqrt2 as the root of x^2 - 2 in [1.41, 1.42]\n```\nIdeally (as above), the `X` in `near X` should have the form of an interval `[1.41,1.42]` that specifies uniquely the root.",
    "created_at": "2016-08-03T23:18:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308375",
    "user": "https://github.com/videlec"
}
```

<div id="comment:2" align="right">comment:2</div>

Shorter sentence would be better.

```
Real Number Field in sqrt2 as the root of x^2 - 2 in [1.41, 1.42]
```
Ideally (as above), the `X` in `near X` should have the form of an interval `[1.41,1.42]` that specifies uniquely the root.



---

archive/issue_comments_308376.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nOr possibly\n\n```\nReal Number Field in sqrt2=1.41421356237309? with defining polynomial x^2 - 2\n```",
    "created_at": "2016-08-03T23:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308376",
    "user": "https://github.com/videlec"
}
```

<div id="comment:3" align="right">comment:3</div>

Or possibly

```
Real Number Field in sqrt2=1.41421356237309? with defining polynomial x^2 - 2
```



---

archive/issue_comments_308377.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n`AlgebraicGenerator` (from `qqbar`) uses \n\n```\n   Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?\n```",
    "created_at": "2016-08-03T23:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308377",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

`AlgebraicGenerator` (from `qqbar`) uses 

```
   Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?
```



---

archive/issue_comments_308378.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@mkoeppe](#comment%3A4):\n> `AlgebraicGenerator` (from `qqbar`) uses \n> \n> ```\n>    Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?\n> ```\n\nWhich is not that bad except the `a in 1.618033988749895?`. Would make more sense with `a in [1.61, 1.62]` or `a = 1.618033988749895?`.",
    "created_at": "2016-08-03T23:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308378",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@mkoeppe](#comment%3A4):
> `AlgebraicGenerator` (from `qqbar`) uses 
> 
> ```
>    Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?
> ```

Which is not that bad except the `a in 1.618033988749895?`. Would make more sense with `a in [1.61, 1.62]` or `a = 1.618033988749895?`.



---

archive/issue_comments_308379.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThis should work for number fields with a real embedding as well as a complex one. The interval notation is painful for the latter, so \"with a=...\" would probably work better. Also good if we end up with number fields with a p-adic embedding specified:\n\n```\nK.<a>=NumberField(x^2+1,embedding=pAdicField(5)(-1).sqrt())\n```",
    "created_at": "2019-02-09T21:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308379",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:7" align="right">comment:7</div>

This should work for number fields with a real embedding as well as a complex one. The interval notation is painful for the latter, so "with a=..." would probably work better. Also good if we end up with number fields with a p-adic embedding specified:

```
K.<a>=NumberField(x^2+1,embedding=pAdicField(5)(-1).sqrt())
```



---

archive/issue_comments_308380.json:
```json
{
    "body": "Branch: **[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)**",
    "created_at": "2019-04-22T11:30:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308380",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)**



---

archive/issue_comments_308381.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab\"><code>d40c9e6</code></a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>\n",
    "created_at": "2019-04-22T14:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308381",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab"><code>d40c9e6</code></a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>




---

archive/issue_comments_308382.json:
```json
{
    "body": "Commit: **[`d40c9e6`](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)**",
    "created_at": "2019-04-22T14:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308382",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`d40c9e6`](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)**



---

archive/issue_comments_308383.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b\"><code>ba3b35d</code></a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>\n",
    "created_at": "2019-04-22T14:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308383",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b"><code>ba3b35d</code></a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>




---

archive/issue_comments_308384.json:
```json
{
    "body": "Changed commit from **[`d40c9e6`](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)** to **[`ba3b35d`](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)**",
    "created_at": "2019-04-22T14:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308384",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d40c9e6`](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)** to **[`ba3b35d`](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)**



---

archive/issue_comments_308385.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIn this patch I am using a format with `with a = ...` now (as suggested by nbruin), which works well also for the complex case:\n\n```\nNumber Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n```\nand for more complicated situations such as this one:\n\n```\n            sage: K.<a> = NumberField(x^4 - 3); K\n            Number Field in a with defining polynomial x^4 - 3\n            sage: H.<b>, from_H = K.subfield(a^2)\n            sage: H\n            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n```\n\nThe output for the following looks a bit strange because printing goes through `sage.rings.real_lazy.LazyBinop`:\n\n```\nsage: QuadraticField(-1, 'a')\nNumber Field in a with defining polynomial x^2 + 1 with a = 1*I\n```\nShould we special case this?",
    "created_at": "2019-04-22T22:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308385",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

In this patch I am using a format with `with a = ...` now (as suggested by nbruin), which works well also for the complex case:

```
Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
```
and for more complicated situations such as this one:

```
            sage: K.<a> = NumberField(x^4 - 3); K
            Number Field in a with defining polynomial x^4 - 3
            sage: H.<b>, from_H = K.subfield(a^2)
            sage: H
            Number Field in b with defining polynomial x^2 - 3 with b = a^2
```

The output for the following looks a bit strange because printing goes through `sage.rings.real_lazy.LazyBinop`:

```
sage: QuadraticField(-1, 'a')
Number Field in a with defining polynomial x^2 + 1 with a = 1*I
```
Should we special case this?



---

archive/issue_comments_308386.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9\"><code>ed3aab0</code></a></td><td><code>Update doctest outputs</code></td></tr></table>\n",
    "created_at": "2019-04-22T22:06:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308386",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9"><code>ed3aab0</code></a></td><td><code>Update doctest outputs</code></td></tr></table>




---

archive/issue_comments_308387.json:
```json
{
    "body": "Changed commit from **[`ba3b35d`](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)** to **[`ed3aab0`](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)**",
    "created_at": "2019-04-22T22:06:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308387",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ba3b35d`](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)** to **[`ed3aab0`](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)**



---

archive/issue_comments_308388.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2019-04-22T22:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308388",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_294991.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294991"
}
```



---

archive/issue_events_294992.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294992"
}
```



---

archive/issue_events_294993.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294993"
}
```



---

archive/issue_comments_308389.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)** to **[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)**",
    "created_at": "2019-04-23T09:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308389",
    "user": "https://github.com/jplab"
}
```

Changed branch from **[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)** to **[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)**



---

archive/issue_comments_308390.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe patchbot gave 2 pyflakes warnings, I repaired one of them, the other one I can not make sure that it does not have side effects.\n\nOtherwise, the patchbot is happy and the resolution looks reasonable. I set it as positive review, if you agree @mkoeppe.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15\"><code>875731c</code></a></td><td><code>fixed one pyflakes</code></td></tr></table>\n",
    "created_at": "2019-04-23T09:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308390",
    "user": "https://github.com/jplab"
}
```

<div id="comment:14" align="right">comment:14</div>

The patchbot gave 2 pyflakes warnings, I repaired one of them, the other one I can not make sure that it does not have side effects.

Otherwise, the patchbot is happy and the resolution looks reasonable. I set it as positive review, if you agree @mkoeppe.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15"><code>875731c</code></a></td><td><code>fixed one pyflakes</code></td></tr></table>




---

archive/issue_comments_308391.json:
```json
{
    "body": "Reviewer: **Jean-Philippe Labb\u00e9**",
    "created_at": "2019-04-23T09:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308391",
    "user": "https://github.com/jplab"
}
```

Reviewer: **Jean-Philippe Labbé**



---

archive/issue_events_294994.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:16:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294994"
}
```



---

archive/issue_events_294995.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:16:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294995"
}
```



---

archive/issue_comments_308392.json:
```json
{
    "body": "Changed commit from **[`ed3aab0`](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)** to **[`875731c`](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)**",
    "created_at": "2019-04-23T09:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308392",
    "user": "https://github.com/jplab"
}
```

Changed commit from **[`ed3aab0`](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)** to **[`875731c`](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)**



---

archive/issue_events_294996.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:18:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294996"
}
```



---

archive/issue_events_294997.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:18:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294997"
}
```



---

archive/issue_comments_308393.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nWhoooops!",
    "created_at": "2019-04-23T09:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308393",
    "user": "https://github.com/jplab"
}
```

<div id="comment:15" align="right">comment:15</div>

Whoooops!



---

archive/issue_comments_308394.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9\"><code>895b962</code></a></td><td><code>Made doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-23T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308394",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9"><code>895b962</code></a></td><td><code>Made doctests pass</code></td></tr></table>




---

archive/issue_comments_308395.json:
```json
{
    "body": "Changed commit from **[`875731c`](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)** to **[`895b962`](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)**",
    "created_at": "2019-04-23T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308395",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`875731c`](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)** to **[`895b962`](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)**



---

archive/issue_events_294998.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T12:10:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294998"
}
```



---

archive/issue_events_294999.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T12:10:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-294999"
}
```



---

archive/issue_comments_308396.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nLet's see if the bot finds more. I hope I did not forget any...",
    "created_at": "2019-04-23T12:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308396",
    "user": "https://github.com/jplab"
}
```

<div id="comment:17" align="right">comment:17</div>

Let's see if the bot finds more. I hope I did not forget any...



---

archive/issue_comments_308397.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFailing doctests",
    "created_at": "2019-04-24T05:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308397",
    "user": "https://github.com/jplab"
}
```

<div id="comment:18" align="right">comment:18</div>

Failing doctests



---

archive/issue_events_295000.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-24T05:58:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295000"
}
```



---

archive/issue_events_295001.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-24T05:58:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295001"
}
```



---

archive/issue_comments_308398.json:
```json
{
    "body": "Changed commit from **[`895b962`](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)** to **[`353b01b`](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)**",
    "created_at": "2019-04-25T08:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308398",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`895b962`](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)** to **[`353b01b`](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)**



---

archive/issue_comments_308399.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73\"><code>353b01b</code></a></td><td><code>Make more doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-25T08:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308399",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73"><code>353b01b</code></a></td><td><code>Make more doctests pass</code></td></tr></table>




---

archive/issue_events_295002.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-25T08:11:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295002"
}
```



---

archive/issue_events_295003.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-25T08:11:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295003"
}
```



---

archive/issue_comments_308400.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499\"><code>2ee8fcc</code></a></td><td><code>Make more doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-25T10:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308400",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499"><code>2ee8fcc</code></a></td><td><code>Make more doctests pass</code></td></tr></table>




---

archive/issue_comments_308401.json:
```json
{
    "body": "Changed commit from **[`353b01b`](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)** to **[`2ee8fcc`](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)**",
    "created_at": "2019-04-25T10:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308401",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`353b01b`](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)** to **[`2ee8fcc`](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)**



---

archive/issue_comments_308402.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n\n```\nsage -t --long src/sage/modular/local_comp/smoothchar.py\n**********************************************************************\nFile \"src/sage/modular/local_comp/smoothchar.py\", line 461, in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_\nFailed example:\n    G.coerce(GK.character(0, [4]))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_[7]>\", line 1, in <module>\n        G.coerce(GK.character(Integer(0), [Integer(4)]))\n      File \"sage/structure/parent.pyx\", line 1114, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10541)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1144, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10470)\n        raise TypeError(_LazyString(_lazy_format, (\"no canonical coercion from %s to %s\", parent(x), self), {}))\n    TypeError: no canonical coercion from Group of smooth characters of Q_3* with values in Number Field in i with defining polynomial x^2 + 1 with i = 1*I to Group of smooth characters of Q_3* with values in Rational Field\n**********************************************************************\n1 item had failures:\n   1 of  14 in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_\n    [303 tests, 1 failure, 2.58 s]\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py\", line 177, in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest\nFailed example:\n    for A in [QQ, ComplexField(16), GF(5), QQ[sqrt(2)]]:\n        print(str(A) + \":\")\n        print(A['x'](p).factor())\nExpected:\n    Rational Field:\n    (54) * (x + 1/3)^2 * (x^2 - 2)\n    Complex Field with 16 bits of precision:\n    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)\n    Finite Field of size 5:\n    (4) * (x + 2)^2 * (x^2 + 3)\n    Number Field in sqrt2 with defining polynomial x^2 - 2:\n    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2\nGot:\n    Rational Field:\n    (54) * (x + 1/3)^2 * (x^2 - 2)\n    Complex Field with 16 bits of precision:\n    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)\n    Finite Field of size 5:\n    (4) * (x + 2)^2 * (x^2 + 3)\n    Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?:\n    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2\n**********************************************************************\n1 item had failures:\n   1 of 111 in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest\n    [110 tests, 1 failure, 0.96 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/modular/local_comp/smoothchar.py  # 1 doctest failed\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nThe first one seems to be taken care of but not the second one.",
    "created_at": "2019-04-25T13:58:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308402",
    "user": "https://github.com/jplab"
}
```

<div id="comment:23" align="right">comment:23</div>


```
sage -t --long src/sage/modular/local_comp/smoothchar.py
**********************************************************************
File "src/sage/modular/local_comp/smoothchar.py", line 461, in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_
Failed example:
    G.coerce(GK.character(0, [4]))
Exception raised:
    Traceback (most recent call last):
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_[7]>", line 1, in <module>
        G.coerce(GK.character(Integer(0), [Integer(4)]))
      File "sage/structure/parent.pyx", line 1114, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10541)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1144, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10470)
        raise TypeError(_LazyString(_lazy_format, ("no canonical coercion from %s to %s", parent(x), self), {}))
    TypeError: no canonical coercion from Group of smooth characters of Q_3* with values in Number Field in i with defining polynomial x^2 + 1 with i = 1*I to Group of smooth characters of Q_3* with values in Rational Field
**********************************************************************
1 item had failures:
   1 of  14 in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_
    [303 tests, 1 failure, 2.58 s]
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py", line 177, in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest
Failed example:
    for A in [QQ, ComplexField(16), GF(5), QQ[sqrt(2)]]:
        print(str(A) + ":")
        print(A['x'](p).factor())
Expected:
    Rational Field:
    (54) * (x + 1/3)^2 * (x^2 - 2)
    Complex Field with 16 bits of precision:
    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)
    Finite Field of size 5:
    (4) * (x + 2)^2 * (x^2 + 3)
    Number Field in sqrt2 with defining polynomial x^2 - 2:
    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2
Got:
    Rational Field:
    (54) * (x + 1/3)^2 * (x^2 - 2)
    Complex Field with 16 bits of precision:
    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)
    Finite Field of size 5:
    (4) * (x + 2)^2 * (x^2 + 3)
    Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?:
    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2
**********************************************************************
1 item had failures:
   1 of 111 in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest
    [110 tests, 1 failure, 0.96 s]
----------------------------------------------------------------------
sage -t --long src/sage/modular/local_comp/smoothchar.py  # 1 doctest failed
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py  # 1 doctest failed
----------------------------------------------------------------------
```

The first one seems to be taken care of but not the second one.



---

archive/issue_comments_308403.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1\"><code>9ce74e3</code></a></td><td><code>Doctest fix in src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py</code></td></tr></table>\n",
    "created_at": "2019-04-26T15:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308403",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1"><code>9ce74e3</code></a></td><td><code>Doctest fix in src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py</code></td></tr></table>




---

archive/issue_comments_308404.json:
```json
{
    "body": "Changed commit from **[`2ee8fcc`](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)** to **[`9ce74e3`](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)**",
    "created_at": "2019-04-26T15:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308404",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2ee8fcc`](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)** to **[`9ce74e3`](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)**



---

archive/issue_comments_308405.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273\"><code>76c384e</code></a></td><td><code>Fix up doctest after change</code></td></tr></table>\n",
    "created_at": "2019-04-26T15:07:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308405",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273"><code>76c384e</code></a></td><td><code>Fix up doctest after change</code></td></tr></table>




---

archive/issue_comments_308406.json:
```json
{
    "body": "Changed commit from **[`9ce74e3`](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)** to **[`76c384e`](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)**",
    "created_at": "2019-04-26T15:07:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308406",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9ce74e3`](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)** to **[`76c384e`](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)**



---

archive/issue_comments_308407.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFixed these two.",
    "created_at": "2019-04-26T15:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308407",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Fixed these two.



---

archive/issue_comments_308408.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,11 +9,18 @@\n Number Field in sqrt2 with defining polynomial x^2 - 2\n ```\n \n-I propose to change the print representation when there is an embedding, for example like this:\n+This ticket changes the print representation when there is an embedding as follows.\n \n ```\n-sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)\n-sage: sqrt2.parent()\n-Real Number Field in sqrt2 as the root of the defining polynomial x^2 - 2 near 1.41421356237309?\n+Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n+```\n+This also works well for more complicated situations such as this one:\n+\n+```\n+            sage: K.<a> = NumberField(x^4 - 3); K\n+            Number Field in a with defining polynomial x^4 - 3\n+            sage: H.<b>, from_H = K.subfield(a^2)\n+            sage: H\n+            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n ```\n \n``````\n",
    "created_at": "2019-04-26T15:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308408",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,11 +9,18 @@
 Number Field in sqrt2 with defining polynomial x^2 - 2
 ```
 
-I propose to change the print representation when there is an embedding, for example like this:
+This ticket changes the print representation when there is an embedding as follows.
 
 ```
-sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)
-sage: sqrt2.parent()
-Real Number Field in sqrt2 as the root of the defining polynomial x^2 - 2 near 1.41421356237309?
+Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
+```
+This also works well for more complicated situations such as this one:
+
+```
+            sage: K.<a> = NumberField(x^4 - 3); K
+            Number Field in a with defining polynomial x^4 - 3
+            sage: H.<b>, from_H = K.subfield(a^2)
+            sage: H
+            Number Field in b with defining polynomial x^2 - 3 with b = a^2
 ```
 
``````




---

archive/issue_events_295004.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-16T17:18:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295004"
}
```



---

archive/issue_events_295005.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-16T17:18:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295005"
}
```



---

archive/issue_comments_308409.json:
```json
{
    "body": "Changed commit from **[`76c384e`](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)** to **[`c4c0088`](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)**",
    "created_at": "2019-05-18T14:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308409",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`76c384e`](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)** to **[`c4c0088`](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)**



---

archive/issue_comments_308410.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c\"><code>c4c0088</code></a></td><td><code>Merge tag '8.8.beta5' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr></table>\n",
    "created_at": "2019-05-18T14:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308410",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c"><code>c4c0088</code></a></td><td><code>Merge tag '8.8.beta5' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr></table>




---

archive/issue_events_295006.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-18T15:00:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295006"
}
```



---

archive/issue_events_295007.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-18T15:00:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295007"
}
```



---

archive/issue_comments_308411.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThere are only 6 failing doctests. That's not bad!\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/qqbar.py  # 5 doctests failed\nsage -t --long src/sage/rings/number_field/order.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-05-22T16:11:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308411",
    "user": "https://github.com/jplab"
}
```

<div id="comment:32" align="right">comment:32</div>

There are only 6 failing doctests. That's not bad!

```
----------------------------------------------------------------------
sage -t --long src/sage/rings/qqbar.py  # 5 doctests failed
sage -t --long src/sage/rings/number_field/order.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_295008.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-22T16:11:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295008"
}
```



---

archive/issue_events_295009.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-22T16:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295009"
}
```



---

archive/issue_comments_308412.json:
```json
{
    "body": "Changed commit from **[`c4c0088`](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)** to **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**",
    "created_at": "2019-05-23T02:08:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308412",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c4c0088`](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)** to **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**



---

archive/issue_comments_308413.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1e151488e23b2705257b96a0f754975925e2c70\"><code>c1e1514</code></a></td><td><code>Merge tag '8.8.beta6' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7\"><code>d404006</code></a></td><td><code>Fix doctests</code></td></tr></table>\n",
    "created_at": "2019-05-23T02:08:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308413",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1e151488e23b2705257b96a0f754975925e2c70"><code>c1e1514</code></a></td><td><code>Merge tag '8.8.beta6' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7"><code>d404006</code></a></td><td><code>Fix doctests</code></td></tr></table>




---

archive/issue_events_295010.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-23T02:08:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295010"
}
```



---

archive/issue_events_295011.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-23T02:08:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295011"
}
```



---

archive/issue_comments_308414.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nLooks good to me. The tests seem to pass on the latest beta and the pyflakes errors are not regressions. I set this to positive review.",
    "created_at": "2019-05-25T10:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308414",
    "user": "https://github.com/jplab"
}
```

<div id="comment:35" align="right">comment:35</div>

Looks good to me. The tests seem to pass on the latest beta and the pyflakes errors are not regressions. I set this to positive review.



---

archive/issue_events_295012.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-25T10:59:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295012"
}
```



---

archive/issue_events_295013.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-25T10:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295013"
}
```



---

archive/issue_comments_308415.json:
```json
{
    "body": "Changed branch from **[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)** to **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**",
    "created_at": "2019-05-28T21:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308415",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)** to **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)**



---

archive/issue_events_295014.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-28T21:07:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295014"
}
```



---

archive/issue_events_295015.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "85911f8476933639d3fbb666d542c11ac3aa950a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-05-28T21:07:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-295015"
}
```



---

archive/issue_comments_308416.json:
```json
{
    "body": "Changed commit from **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)** to none",
    "created_at": "2019-06-20T15:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308416",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`d404006`](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)** to none



---

archive/issue_comments_308417.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThis ticket is probably causing (randomly) **infinite loops** on several patchbots.\n\nFor example, see\n\nhttps://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short\n\nEDIT:\nthe problematic doctest is\n\n```\nFile \"src/sage/structure/parent.pyx\", line 1734, in sage.structure.parent.Parent.hom.register_embedding\nFailed example:\n    K.coerce_embedding()(a)\nException raised:\n...\nRuntimeError: maximum recursion depth exceeded while calling a Python object\n```",
    "created_at": "2019-06-20T15:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308417",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:37" align="right">comment:37</div>

This ticket is probably causing (randomly) **infinite loops** on several patchbots.

For example, see

https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short

EDIT:
the problematic doctest is

```
File "src/sage/structure/parent.pyx", line 1734, in sage.structure.parent.Parent.hom.register_embedding
Failed example:
    K.coerce_embedding()(a)
Exception raised:
...
RuntimeError: maximum recursion depth exceeded while calling a Python object
```



---

archive/issue_comments_308418.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@fchapoton](#comment%3A37):\n> This ticket is probably causing (randomly) **infinite loops** on several patchbots.\n> \n> For example, see\n> \n> https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short\n> \n> EDIT:\n> the problematic doctest is\n> \n> ```\n> File \"src/sage/structure/parent.pyx\", line 1734, in sage.structure.parent.Parent.hom.register_embedding\n> Failed example:\n>     K.coerce_embedding()(a)\n> Exception raised:\n> ...\n> RuntimeError: maximum recursion depth exceeded while calling a Python object\n> ```\n\nThe source code that changed is\n\n```diff\n--- a/src/sage/rings/number_field/number_field.py\n+++ b/src/sage/rings/number_field/number_field.py\n@@ -3087,9 +3089,16 @@ class NumberField_generic(WithEqualityById, number_field_base.NumberField):\n         \"\"\"\n-        return \"Number Field in %s with defining polynomial %s\"%(\n-                   self.variable_name(), self.polynomial())\n+        result = \"Number Field in {} with defining polynomial {}\".format(self.variable_name(), self.polynomial())\n+        gen = self.gen_embedding()\n+        if gen is not None:\n+            result += \" with {} = {}\".format(self.variable_name(), gen)\n+        return result\n```\n\nThe rest of the diff consist of adapting the doctests. Where could the infinite loop come from? Hmm.",
    "created_at": "2019-06-21T09:25:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308418",
    "user": "https://github.com/jplab"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@fchapoton](#comment%3A37):
> This ticket is probably causing (randomly) **infinite loops** on several patchbots.
> 
> For example, see
> 
> https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short
> 
> EDIT:
> the problematic doctest is
> 
> ```
> File "src/sage/structure/parent.pyx", line 1734, in sage.structure.parent.Parent.hom.register_embedding
> Failed example:
>     K.coerce_embedding()(a)
> Exception raised:
> ...
> RuntimeError: maximum recursion depth exceeded while calling a Python object
> ```

The source code that changed is

```diff
--- a/src/sage/rings/number_field/number_field.py
+++ b/src/sage/rings/number_field/number_field.py
@@ -3087,9 +3089,16 @@ class NumberField_generic(WithEqualityById, number_field_base.NumberField):
         """
-        return "Number Field in %s with defining polynomial %s"%(
-                   self.variable_name(), self.polynomial())
+        result = "Number Field in {} with defining polynomial {}".format(self.variable_name(), self.polynomial())
+        gen = self.gen_embedding()
+        if gen is not None:
+            result += " with {} = {}".format(self.variable_name(), gen)
+        return result
```

The rest of the diff consist of adapting the doctests. Where could the infinite loop come from? Hmm.



---

archive/issue_comments_308419.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nIt appears that using the embedding in the repr is a very bad idea...\n\nEven when this problematic doctest works, calling\n\n```\nK.coerce_embedding()\n```\nafter this doctest makes sage crash..\nAnd the culprit are really those 2 \"innocent\" added lines..",
    "created_at": "2019-06-21T09:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308419",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">comment:39</div>

It appears that using the embedding in the repr is a very bad idea...

Even when this problematic doctest works, calling

```
K.coerce_embedding()
```
after this doctest makes sage crash..
And the culprit are really those 2 "innocent" added lines..



---

archive/issue_comments_308420.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI have made #28036 to revert the changes made here.",
    "created_at": "2019-06-21T11:00:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308420",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:40" align="right">comment:40</div>

I have made #28036 to revert the changes made here.



---

archive/issue_comments_308421.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nMaybe changing this line would be a way out:\n\n```\nreturn copy(self._embedding) # It might be overkill to make a copy here\n```",
    "created_at": "2019-06-21T12:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-308421",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:41" align="right">comment:41</div>

Maybe changing this line would be a way out:

```
return copy(self._embedding) # It might be overkill to make a copy here
```
