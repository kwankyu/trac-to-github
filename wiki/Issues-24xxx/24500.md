# Issue 24500: Implement actions using _act_ instead of _call_

archive/issues_024263.json:
```json
{
    "body": "We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n\nThe current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n\nWork on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n\n**CC:**  @videlec @tscrim\n\n**Branch/Commit:** [3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/24500\n\n",
    "closed_at": "2018-11-29T08:13:34Z",
    "created_at": "2018-01-09T14:54:23Z",
    "labels": [
        "component: coercion",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "title": "Implement actions using _act_ instead of _call_",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/24500",
    "user": "https://github.com/jdemeyer"
}
```
We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.

The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.

Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.

**CC:**  @videlec @tscrim

**Branch/Commit:** [3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)

**Reviewer:** Travis Scrimshaw

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/24500





---

archive/issue_comments_373513.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.\n+\n+We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.\n+\n+Whatever we do, we should document things as currently there is no documentation of `Action`.\n``````\n",
    "created_at": "2018-01-09T15:39:34Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373513",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.
+
+We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.
+
+Whatever we do, we should document things as currently there is no documentation of `Action`.
``````




---

archive/issue_comments_373514.json:
```json
{
    "body": "**Dependencies:** #5574",
    "created_at": "2018-01-18T10:14:10Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373514",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #5574



---

archive/issue_comments_373515.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)",
    "created_at": "2018-01-30T13:45:22Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373515",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)



---

archive/issue_comments_373516.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd3b5b594d1dd98b3ecc7256a62f79f5afc73b0f\">dd3b5b5</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03\">f2b676e</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-01-30T13:53:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd3b5b594d1dd98b3ecc7256a62f79f5afc73b0f">dd3b5b5</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03">f2b676e</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_373517.json:
```json
{
    "body": "**Commit:** [f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)",
    "created_at": "2018-01-30T13:53:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)



---

archive/issue_comments_373518.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373518",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_comments_373519.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.\n+We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n \n-We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.\n+The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n-Whatever we do, we should document things as currently there is no documentation of `Action`.\n+Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n``````\n",
    "created_at": "2018-01-30T13:57:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373519",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.
+We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
 
-We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.
+The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
-Whatever we do, we should document things as currently there is no documentation of `Action`.
+Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
``````




---

archive/issue_events_219286.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "rename": {
        "from": "Optimize Action.__call__",
        "to": "Implement action using _act_ instead of _call_"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219286"
}
```



---

archive/issue_events_219287.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "component: performance",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219287"
}
```



---

archive/issue_events_219288.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "component: coercion",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219288"
}
```



---

archive/issue_events_219289.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219289"
}
```



---

archive/issue_comments_373520.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n+We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n \n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n``````\n",
    "created_at": "2018-01-30T14:01:39Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373520",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
+We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
 
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
``````




---

archive/issue_events_219290.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T14:23:54Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "rename": {
        "from": "Implement action using _act_ instead of _call_",
        "to": "Implement actions using _act_ instead of _call_"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219290"
}
```



---

archive/issue_comments_373521.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,69 @@\n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n+\n+**Timings** (compared to before #24247 and #5574):\n+\n+**GF(2<sup>n</sup>)<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 383 ns per loop\n+```\n+\n+After:\n+\n+```\n+sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 635 ns per loop\n+```\n+\n+**RDF<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 156 ns per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 185 ns per loop\n+```\n+\n+**ideal<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 13.3 \u00b5s per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 14.1 \u00b5s per loop\n+```\n+\n+**AA<sup>QQ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 12.8 \u00b5s per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 16.6 \u00b5s per loop\n+```\n``````\n",
    "created_at": "2018-01-30T14:52:42Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373521",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,69 @@
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
+
+**Timings** (compared to before #24247 and #5574):
+
+**GF(2<sup>n</sup>)<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 383 ns per loop
+```
+
+After:
+
+```
+sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 635 ns per loop
+```
+
+**RDF<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 156 ns per loop
+```
+
+After:
+
+```
+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 185 ns per loop
+```
+
+**ideal<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 13.3 µs per loop
+```
+
+After:
+
+```
+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 14.1 µs per loop
+```
+
+**AA<sup>QQ</sup>**
+
+Before:
+
+```
+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 12.8 µs per loop
+```
+
+After:
+
+```
+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 16.6 µs per loop
+```
``````




---

archive/issue_comments_373522.json:
```json
{
    "body": "<a id='comment:9'></a>\nDo you have timings with this ticket (at least, my understanding of the description is the \"after\" does not include this ticket)?",
    "created_at": "2018-01-30T19:00:02Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373522",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Do you have timings with this ticket (at least, my understanding of the description is the "after" does not include this ticket)?



---

archive/issue_comments_373523.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@tscrim](#comment%3A9):\n> Do you have timings with this ticket (at least, my understanding of the description is the \"after\" does not include this ticket)?\n\nThe \"after\" does include this ticket.",
    "created_at": "2018-01-30T19:04:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373523",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Replying to [@tscrim](#comment%3A9):
> Do you have timings with this ticket (at least, my understanding of the description is the "after" does not include this ticket)?

The "after" does include this ticket.



---

archive/issue_comments_373524.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n \n **Timings** (compared to before #24247 and #5574):\n+\n+Note: \"before\" timings are without #24247, #5574 and #24500. \"after\" timings are with #24247, #5574 and #24500.\n \n **GF(2<sup>n</sup>)<sup>ZZ</sup>**\n \n``````\n",
    "created_at": "2018-01-30T19:15:50Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373524",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
 
 **Timings** (compared to before #24247 and #5574):
+
+Note: "before" timings are without #24247, #5574 and #24500. "after" timings are with #24247, #5574 and #24500.
 
 **GF(2<sup>n</sup>)<sup>ZZ</sup>**
 
``````




---

archive/issue_comments_373525.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [@jdemeyer](#comment%3A10):\n> The \"after\" does include this ticket.\n\nDid you invert the \u201cbefore\u201d and \u201cafter\u201d parts then?",
    "created_at": "2018-01-31T15:49:44Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373525",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:12'></a>
Replying to [@jdemeyer](#comment%3A10):
> The "after" does include this ticket.

Did you invert the “before” and “after” parts then?



---

archive/issue_comments_373526.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [@mezzarobba](#comment%3A12):\n> Did you invert the \u201cbefore\u201d and \u201cafter\u201d parts then?\n\nNo, I did not...",
    "created_at": "2018-01-31T15:57:44Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373526",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Replying to [@mezzarobba](#comment%3A12):
> Did you invert the “before” and “after” parts then?

No, I did not...



---

archive/issue_comments_373527.json:
```json
{
    "body": "<a id='comment:14'></a>\nOn 8.2.beta4:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 343 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 137 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.62 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7 \u00b5s per loop\n```\nvs with #5574:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 341 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 139 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.71 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 8.75 \u00b5s per loop\n```\nvs with #24500:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 356 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 141 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.53 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 8.91 \u00b5s per loop\n```\n\nSo I can explain why the first test is slower: there is an additional `if action._is_left` that is needed to be performed that previously was not there because powering could assume things in a specific order. The last one slowing down is due to #5574 (and some numerical noise). The middle two are almost identical (at least within the numerical noise I was getting), which is expected considering they perform the same number of checks in Cython.\n\nHowever, I did get an improvement when something was calling `is_left()` in Python:\n\n```\nsage: from brial import BooleanMonomialMonoid\nsage: P.<x,y,z> = BooleanPolynomialRing(3)\nsage: M = BooleanMonomialMonoid(P)\nsage: x = M(x); xy = M(x*y); z=M(z); n=2\nsage: timeit('x * n', number=10000, repeat=20)\n10000 loops, best of 20: 6.52 \u00b5s per loop\nsage: timeit('n * x', number=10000, repeat=20)\n10000 loops, best of 20: 6.43 \u00b5s per loop\n```\nvs with #24500\n\n```\nsage: timeit('n * x', number=10000, repeat=20)\n10000 loops, best of 20: 6.14 \u00b5s per loop\nsage: timeit('x * n', number=10000, repeat=20)\n10000 loops, best of 20: 6.17 \u00b5s per loop\n```\n\nSo my conclusion is this ticket does do a little bit of optimizing in certain cases and a regression in others. My current inclination is to give this ticket a positive review because it makes the action interface more clean by removing some of the implementation burden (i.e., deciding which input is which type). Do you agree with my assessment? Anyone else have any objections?",
    "created_at": "2018-02-08T21:08:50Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373527",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
On 8.2.beta4:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 343 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 137 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.62 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7 µs per loop
```
vs with #5574:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 341 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 139 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.71 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 8.75 µs per loop
```
vs with #24500:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 356 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 141 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.53 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 8.91 µs per loop
```

So I can explain why the first test is slower: there is an additional `if action._is_left` that is needed to be performed that previously was not there because powering could assume things in a specific order. The last one slowing down is due to #5574 (and some numerical noise). The middle two are almost identical (at least within the numerical noise I was getting), which is expected considering they perform the same number of checks in Cython.

However, I did get an improvement when something was calling `is_left()` in Python:

```
sage: from brial import BooleanMonomialMonoid
sage: P.<x,y,z> = BooleanPolynomialRing(3)
sage: M = BooleanMonomialMonoid(P)
sage: x = M(x); xy = M(x*y); z=M(z); n=2
sage: timeit('x * n', number=10000, repeat=20)
10000 loops, best of 20: 6.52 µs per loop
sage: timeit('n * x', number=10000, repeat=20)
10000 loops, best of 20: 6.43 µs per loop
```
vs with #24500

```
sage: timeit('n * x', number=10000, repeat=20)
10000 loops, best of 20: 6.14 µs per loop
sage: timeit('x * n', number=10000, repeat=20)
10000 loops, best of 20: 6.17 µs per loop
```

So my conclusion is this ticket does do a little bit of optimizing in certain cases and a regression in others. My current inclination is to give this ticket a positive review because it makes the action interface more clean by removing some of the implementation burden (i.e., deciding which input is which type). Do you agree with my assessment? Anyone else have any objections?



---

archive/issue_comments_373528.json:
```json
{
    "body": "**Changing dependencies** from \"#5574\" to \"\".",
    "created_at": "2018-03-08T09:35:34Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373528",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#5574" to "".



---

archive/issue_events_219291.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:35:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219291"
}
```



---

archive/issue_events_219292.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:35:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219292"
}
```



---

archive/issue_comments_373529.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dc30bf642d0f8afc9c19e0fe464382c4270cffe\">3dc30bf</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c\">0587d3f</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-03-08T09:38:47Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dc30bf642d0f8afc9c19e0fe464382c4270cffe">3dc30bf</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c">0587d3f</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_373530.json:
```json
{
    "body": "**Changing commit** from \"[f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)\" to \"[0587d3f4c1f2a75ecf095461810414ee43a35b1c](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)\".",
    "created_at": "2018-03-08T09:38:47Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)" to "[0587d3f4c1f2a75ecf095461810414ee43a35b1c](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)".



---

archive/issue_events_219293.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:39:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219293"
}
```



---

archive/issue_events_219294.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:39:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219294"
}
```



---

archive/issue_comments_373531.json:
```json
{
    "body": "<a id='comment:18'></a>\nMany failing tests involving valuations...",
    "created_at": "2018-03-08T09:47:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373531",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Many failing tests involving valuations...



---

archive/issue_events_219295.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:47:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219295"
}
```



---

archive/issue_events_219296.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:47:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219296"
}
```



---

archive/issue_comments_373532.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a607ecb6b4e74a7f77aceda7b62bfc3130663943\">a607ecb</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d\">30d8bac</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-03-08T10:02:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a607ecb6b4e74a7f77aceda7b62bfc3130663943">a607ecb</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d">30d8bac</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_373533.json:
```json
{
    "body": "**Changing commit** from \"[0587d3f4c1f2a75ecf095461810414ee43a35b1c](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)\" to \"[30d8bac7fa31db13511c867ec2ca95de76d2313d](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)\".",
    "created_at": "2018-03-08T10:02:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373533",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0587d3f4c1f2a75ecf095461810414ee43a35b1c](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)" to "[30d8bac7fa31db13511c867ec2ca95de76d2313d](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)".



---

archive/issue_events_219297.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T10:02:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219297"
}
```



---

archive/issue_events_219298.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T10:02:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219298"
}
```



---

archive/issue_events_219299.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T08:04:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219299"
}
```



---

archive/issue_events_219300.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T08:04:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219300"
}
```



---

archive/issue_comments_373534.json:
```json
{
    "body": "**Changing commit** from \"[30d8bac7fa31db13511c867ec2ca95de76d2313d](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)\" to \"[0406b4a1a2b91dc7976a5a7271acc770c702eab5](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)\".",
    "created_at": "2018-04-06T09:48:53Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[30d8bac7fa31db13511c867ec2ca95de76d2313d](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)" to "[0406b4a1a2b91dc7976a5a7271acc770c702eab5](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)".



---

archive/issue_comments_373535.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66\">800d30b</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5\">0406b4a</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-04-06T09:48:53Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66">800d30b</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5">0406b4a</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_events_219301.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T09:50:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219301"
}
```



---

archive/issue_events_219302.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T09:50:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219302"
}
```



---

archive/issue_comments_373536.json:
```json
{
    "body": "<a id='comment:24'></a>\nPart of the slowdown in this ticket was caused by the second commit removing `Set_PythonType`. I'll drop that commit, then the regressions are gone for me.",
    "created_at": "2018-04-06T12:34:39Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373536",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Part of the slowdown in this ticket was caused by the second commit removing `Set_PythonType`. I'll drop that commit, then the regressions are gone for me.



---

archive/issue_comments_373537.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:",
    "created_at": "2018-04-06T12:35:23Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:



---

archive/issue_comments_373538.json:
```json
{
    "body": "**Changing commit** from \"[0406b4a1a2b91dc7976a5a7271acc770c702eab5](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)\" to \"[800d30b2d3ff09d00978b9223cbeff966d468f66](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)\".",
    "created_at": "2018-04-06T12:35:23Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0406b4a1a2b91dc7976a5a7271acc770c702eab5](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)" to "[800d30b2d3ff09d00978b9223cbeff966d468f66](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)".



---

archive/issue_comments_373539.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01\">3a0958d</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr></table>\n",
    "created_at": "2018-11-26T11:41:08Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01">3a0958d</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr></table>




---

archive/issue_comments_373540.json:
```json
{
    "body": "**Changing commit** from \"[800d30b2d3ff09d00978b9223cbeff966d468f66](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)\" to \"[3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)\".",
    "created_at": "2018-11-26T11:41:08Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373540",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[800d30b2d3ff09d00978b9223cbeff966d468f66](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)" to "[3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)".



---

archive/issue_comments_373541.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,71 +3,3 @@\n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n-\n-**Timings** (compared to before #24247 and #5574):\n-\n-Note: \"before\" timings are without #24247, #5574 and #24500. \"after\" timings are with #24247, #5574 and #24500.\n-\n-**GF(2<sup>n</sup>)<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 383 ns per loop\n-```\n-\n-After:\n-\n-```\n-sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 635 ns per loop\n-```\n-\n-**RDF<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 156 ns per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 185 ns per loop\n-```\n-\n-**ideal<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 13.3 \u00b5s per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 14.1 \u00b5s per loop\n-```\n-\n-**AA<sup>QQ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 12.8 \u00b5s per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 16.6 \u00b5s per loop\n-```\n``````\n",
    "created_at": "2018-11-26T11:41:26Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373541",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,71 +3,3 @@
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
-
-**Timings** (compared to before #24247 and #5574):
-
-Note: "before" timings are without #24247, #5574 and #24500. "after" timings are with #24247, #5574 and #24500.
-
-**GF(2<sup>n</sup>)<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 383 ns per loop
-```
-
-After:
-
-```
-sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 635 ns per loop
-```
-
-**RDF<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 156 ns per loop
-```
-
-After:
-
-```
-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 185 ns per loop
-```
-
-**ideal<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 13.3 µs per loop
-```
-
-After:
-
-```
-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 14.1 µs per loop
-```
-
-**AA<sup>QQ</sup>**
-
-Before:
-
-```
-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 12.8 µs per loop
-```
-
-After:
-
-```
-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 16.6 µs per loop
-```
``````




---

archive/issue_events_219303.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219303"
}
```



---

archive/issue_events_219304.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219304"
}
```



---

archive/issue_comments_373542.json:
```json
{
    "body": "<a id='comment:28'></a>\nLGTM. Sorry I let this ticket fall off my radar.",
    "created_at": "2018-11-27T02:44:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373542",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>
LGTM. Sorry I let this ticket fall off my radar.



---

archive/issue_events_219305.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219305"
}
```



---

archive/issue_events_219306.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219306"
}
```



---

archive/issue_comments_373543.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-11-27T02:44:20Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373543",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_373544.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)\" to \"[3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)\".",
    "created_at": "2018-11-29T08:13:34Z",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-373544",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)" to "[3a0958dcb4da8ee91b28163172061666de38bd01](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)".



---

archive/issue_events_219307.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-29T08:13:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219307"
}
```



---

archive/issue_events_219308.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "76496dd14a768799bbb5db4407460f275fa36637",
    "created_at": "2018-11-29T08:13:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-219308"
}
```
