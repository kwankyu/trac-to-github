# Issue 32167: fricas gets daemonized and eats up the CPU when Sage terminal is closed

archive/issues_031930.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nHere are the steps to reproduce:\n\n- start Sage in a terminal\n- run a Sage command involving fricas, e.g.\n   `sage: integrate(sin(x),x,0,1,algorithm='fricas')`\n- in another terminal, track the evolution of fricas process : \n   `ps -eo pid,ppid,pcpu,comm | grep FRICAS`\n- if you quit Sage with `exit` or `CTRL+D`, you get a message `Exiting FriCAS with PID ...` and fricas process terminates, great.\n- if instead you close the terminal running Sage, you see that the fricas process gets daemonized (its parent becomes `PID 1`), and its CPU usage inreases and heats your computer.\n\n\n\nComponent: **packages: optional**\n\nKeywords: **FriCAS**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32167_\n\n",
    "created_at": "2021-07-09T11:15:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fricas gets daemonized and eats up the CPU when Sage terminal is closed",
    "type": "issue",
    "updated_at": "2023-01-29T23:06:23Z",
    "url": "https://github.com/sagemath/sage/issues/32167",
    "user": "https://github.com/sagetrac-tmonteil"
}
```
<div id="comment:0"></div>

Here are the steps to reproduce:

- start Sage in a terminal
- run a Sage command involving fricas, e.g.
   `sage: integrate(sin(x),x,0,1,algorithm='fricas')`
- in another terminal, track the evolution of fricas process : 
   `ps -eo pid,ppid,pcpu,comm | grep FRICAS`
- if you quit Sage with `exit` or `CTRL+D`, you get a message `Exiting FriCAS with PID ...` and fricas process terminates, great.
- if instead you close the terminal running Sage, you see that the fricas process gets daemonized (its parent becomes `PID 1`), and its CPU usage inreases and heats your computer.



Component: **packages: optional**

Keywords: **FriCAS**

_Issue created by migration from https://trac.sagemath.org/ticket/32167_





---

archive/issue_events_441336.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-07-09T11:15:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441336"
}
```



---

archive/issue_events_441337.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-07-09T11:15:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441337"
}
```



---

archive/issue_events_441338.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-07-09T11:15:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441338"
}
```



---

archive/issue_events_441339.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-07-09T11:15:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441339"
}
```



---

archive/issue_comments_518075.json:
```json
{
    "body": "Changed keywords from none to **FriCAS**",
    "created_at": "2021-07-09T20:18:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32167#issuecomment-518075",
    "user": "https://github.com/mantepse"
}
```

Changed keywords from none to **FriCAS**



---

archive/issue_comments_518076.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI cannot reproduce this :-(\n\nDoes this always happen on your computer?",
    "created_at": "2021-07-09T20:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32167#issuecomment-518076",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:2" align="right">comment:2</div>

I cannot reproduce this :-(

Does this always happen on your computer?



---

archive/issue_comments_518077.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@mantepse](#comment%3A2):\n> I cannot reproduce this :-(\n> \n> Does this always happen on your computer?\n\nI can reproduce it consistently, with the procedure above. I am using Debian buster GNU/Linux 64bits.\n\nHowever, i am on the commit 7eeb80c9e1b4e656e0616d157fbc16b31f94ba52 which installs fricas 1.3.7.p1.",
    "created_at": "2021-07-10T10:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32167#issuecomment-518077",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@mantepse](#comment%3A2):
> I cannot reproduce this :-(
> 
> Does this always happen on your computer?

I can reproduce it consistently, with the procedure above. I am using Debian buster GNU/Linux 64bits.

However, i am on the commit 7eeb80c9e1b4e656e0616d157fbc16b31f94ba52 which installs fricas 1.3.7.p1.



---

archive/issue_comments_518078.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI see this behaviour now, too :-(",
    "created_at": "2021-07-20T14:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32167#issuecomment-518078",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:4" align="right">comment:4</div>

I see this behaviour now, too :-(



---

archive/issue_events_441340.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441340"
}
```



---

archive/issue_events_441341.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441341"
}
```



---

archive/issue_events_441342.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441342"
}
```



---

archive/issue_events_441343.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441343"
}
```



---

archive/issue_events_441344.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441344"
}
```



---

archive/issue_events_441345.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441345"
}
```



---

archive/issue_events_441346.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441346"
}
```



---

archive/issue_events_441347.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441347"
}
```



---

archive/issue_events_441348.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-29T23:06:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32167",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32167#event-441348"
}
```
