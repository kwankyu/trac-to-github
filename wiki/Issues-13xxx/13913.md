# Issue 13913: Provide a "stripped" gcc 4.7.2 spkg

archive/issues_013709.json:
```json
{
    "body": "GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...\n\nTry the spkg at [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg)\n\nThe stripped src dir can be produced using the `spkg-src` provided in the spkg.\n\n**CC:**  @jdemeyer\n\n**Keywords:** spkg gcc\n\n**Reviewer:** Jean-Pierre Flori\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/13913\n\n",
    "closed_at": "2013-01-09T08:59:09Z",
    "created_at": "2013-01-05T14:58:26Z",
    "labels": [
        "component: packages: optional",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "title": "Provide a \"stripped\" gcc 4.7.2 spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13913",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```
GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...

Try the spkg at [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg)

The stripped src dir can be produced using the `spkg-src` provided in the spkg.

**CC:**  @jdemeyer

**Keywords:** spkg gcc

**Reviewer:** Jean-Pierre Flori

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/13913





---

archive/issue_comments_166916.json:
```json
{
    "body": "<a id='comment:1'></a>\nNot sure we should really get rid of the testsuites dir, but gcc, g++ and gfortran (seem to) build without it.",
    "created_at": "2013-01-07T15:29:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166916",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:1'></a>
Not sure we should really get rid of the testsuites dir, but gcc, g++ and gfortran (seem to) build without it.



---

archive/issue_comments_166917.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...\n+\n+Try spkg at\n+http://boxen.sage.math.washington.edu/home/jpflori/gcc-4.7.2.p0.spkg\n+\n+The stripped src dir can be produced using the spkg-dist provided in the spkg.\n``````\n",
    "created_at": "2013-01-07T15:29:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166917",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,6 @@
 GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...
+
+Try spkg at
+http://boxen.sage.math.washington.edu/home/jpflori/gcc-4.7.2.p0.spkg
+
+The stripped src dir can be produced using the spkg-dist provided in the spkg.
``````




---

archive/issue_comments_166918.json:
```json
{
    "body": "**Author:** Jean-Pierre Flori",
    "created_at": "2013-01-07T15:29:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166918",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Author:** Jean-Pierre Flori



---

archive/issue_events_120286.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2013-01-07T15:29:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13913#event-120286"
}
```



---

archive/issue_comments_166919.json:
```json
{
    "body": "<a id='comment:2'></a>\nWow, we both had almost exactly the same idea.",
    "created_at": "2013-01-07T15:33:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166919",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Wow, we both had almost exactly the same idea.



---

archive/issue_comments_166920.json:
```json
{
    "body": "<a id='comment:3'></a>\nMy spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg) (also removed Link Time Optimization and Native Language Support).\n\nMy `spkg-src` script (don't call it `spkg-dist` as that is really meant for scripts which create a spkg):\n\n```\n#!/bin/sh\n# Remove some unneeded pieces from GCC, after downloading and\n# extracting the sources and renaming the directory to src/.\n\ncd src || exit $?\n\nrm MD5SUMS\nrm -r maintainer-scripts\n\n# Remove zlib, since Sage already ships with zlib\n# and we build GCC with --with-system-zlib.\nrm -r zlib\n\n# Remove Native Language Support\nrm -r gcc/po libcpp/po\n\n# Remove support for Link Time Optimization\nrm -r lto-plugin\n\n# Remove all files for languages other than C, C++, Fortran.\nrm -r libada gnattools libgo libffi libjava boehm-gc libobjc\ncd gcc\nrm -r ada go java objc objcp testsuite\n```",
    "created_at": "2013-01-07T15:35:44Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166920",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
My spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg) (also removed Link Time Optimization and Native Language Support).

My `spkg-src` script (don't call it `spkg-dist` as that is really meant for scripts which create a spkg):

```
#!/bin/sh
# Remove some unneeded pieces from GCC, after downloading and
# extracting the sources and renaming the directory to src/.

cd src || exit $?

rm MD5SUMS
rm -r maintainer-scripts

# Remove zlib, since Sage already ships with zlib
# and we build GCC with --with-system-zlib.
rm -r zlib

# Remove Native Language Support
rm -r gcc/po libcpp/po

# Remove support for Link Time Optimization
rm -r lto-plugin

# Remove all files for languages other than C, C++, Fortran.
rm -r libada gnattools libgo libffi libjava boehm-gc libobjc
cd gcc
rm -r ada go java objc objcp testsuite
```



---

archive/issue_comments_166921.json:
```json
{
    "body": "<a id='comment:4'></a>\nNot sure whether we should remove [libitm](http://gcc.gnu.org/wiki/TransactionalMemory) (although currently nothing in Sage uses this feature).",
    "created_at": "2013-01-07T15:38:20Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166921",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Not sure whether we should remove [libitm](http://gcc.gnu.org/wiki/TransactionalMemory) (although currently nothing in Sage uses this feature).



---

archive/issue_comments_166922.json:
```json
{
    "body": "<a id='comment:5'></a>\nLet's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.",
    "created_at": "2013-01-08T09:23:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166922",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.



---

archive/issue_comments_166923.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,5 @@\n GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...\n \n-Try spkg at\n-http://boxen.sage.math.washington.edu/home/jpflori/gcc-4.7.2.p0.spkg\n+Try the spkg at [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg)\n \n-The stripped src dir can be produced using the spkg-dist provided in the spkg.\n+The stripped src dir can be produced using the `spkg-src` provided in the spkg.\n``````\n",
    "created_at": "2013-01-08T09:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166923",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,5 @@
 GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...
 
-Try spkg at
-http://boxen.sage.math.washington.edu/home/jpflori/gcc-4.7.2.p0.spkg
+Try the spkg at [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg)
 
-The stripped src dir can be produced using the spkg-dist provided in the spkg.
+The stripped src dir can be produced using the `spkg-src` provided in the spkg.
``````




---

archive/issue_comments_166924.json:
```json
{
    "body": "Spkg diff, for review only.",
    "created_at": "2013-01-08T09:37:25Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166924",
    "user": "https://github.com/jdemeyer"
}
```

Spkg diff, for review only.



---

archive/attachments_019453.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "gcc-4.7.2.p0.diff",
    "asset_url": "tarball://root/attachments/ticket13913/gcc-4.7.2.p0.diff",
    "created_at": "2013-01-08T09:38:35Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13913/gcc-4.7.2.p0.diff",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_166925.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Attachment:** [gcc-4.7.2.p0.diff](https://github.com/sagemath/sage/files/ticket13913/gcc-4.7.2.p0.diff)\n\nJean-Pierre, could you review my package please?",
    "created_at": "2013-01-08T09:38:35Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166925",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
**Attachment:** [gcc-4.7.2.p0.diff](https://github.com/sagemath/sage/files/ticket13913/gcc-4.7.2.p0.diff)

Jean-Pierre, could you review my package please?



---

archive/issue_comments_166926.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@jdemeyer](#comment%3A5):\n> Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.\n\nJust a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?\nOr is it actually used or necessary somewhere?",
    "created_at": "2013-01-08T09:52:55Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166926",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:8'></a>
Replying to [@jdemeyer](#comment%3A5):
> Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.

Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?
Or is it actually used or necessary somewhere?



---

archive/issue_comments_166927.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jpflori](#comment%3A8):\n> Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?\n\nIt could be done I guess.  Except of course for user-facing packages, i.e. packages where the user is likely to see the output of.  I know there are some efforts to internationalize the Sage Notebook for example.",
    "created_at": "2013-01-08T10:37:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166927",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [jpflori](#comment%3A8):
> Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?

It could be done I guess.  Except of course for user-facing packages, i.e. packages where the user is likely to see the output of.  I know there are some efforts to internationalize the Sage Notebook for example.



---

archive/issue_comments_166928.json:
```json
{
    "body": "<a id='comment:10'></a>\nLittle remark: do we need the intl directory?\nI guess this is NLS related and in the end is not used because of the --disable-nls flag.\nI've just built without it and everything seems fine.\n(Without it the --disable-nls flag should not be that useful but let's keep it in anyway.)",
    "created_at": "2013-01-08T10:43:03Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166928",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:10'></a>
Little remark: do we need the intl directory?
I guess this is NLS related and in the end is not used because of the --disable-nls flag.
I've just built without it and everything seems fine.
(Without it the --disable-nls flag should not be that useful but let's keep it in anyway.)



---

archive/issue_comments_166929.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jpflori](#comment%3A10):\n> Little remark: do we need the intl directory?\n\nI'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.",
    "created_at": "2013-01-08T10:52:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166929",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Replying to [jpflori](#comment%3A10):
> Little remark: do we need the intl directory?

I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.



---

archive/issue_comments_166930.json:
```json
{
    "body": "**Reviewer:** Jean-Pierre Flori",
    "created_at": "2013-01-08T10:54:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166930",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Reviewer:** Jean-Pierre Flori



---

archive/issue_comments_166931.json:
```json
{
    "body": "**Changing author** from \"Jean-Pierre Flori\" to \"Jeroen Demeyer\".",
    "created_at": "2013-01-08T10:54:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166931",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing author** from "Jean-Pierre Flori" to "Jeroen Demeyer".



---

archive/issue_events_120287.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2013-01-08T10:54:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13913#event-120287"
}
```



---

archive/issue_events_120288.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2013-01-08T10:54:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13913#event-120288"
}
```



---

archive/issue_comments_166932.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [@jdemeyer](#comment%3A11):\n> Replying to [jpflori](#comment%3A10):\n> > Little remark: do we need the intl directory?\n\n> I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.\n\nAgreed.",
    "created_at": "2013-01-08T10:54:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166932",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>
Replying to [@jdemeyer](#comment%3A11):
> Replying to [jpflori](#comment%3A10):
> > Little remark: do we need the intl directory?

> I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.

Agreed.



---

archive/issue_comments_166933.json:
```json
{
    "body": "<a id='comment:13'></a>\n(But if you wanna test it, I feel it should work without intl as well, not even using system stuff if you don't push configure to do it from what I quickly saw in configure's, makefiles and m4 macros.)",
    "created_at": "2013-01-08T11:05:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166933",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>
(But if you wanna test it, I feel it should work without intl as well, not even using system stuff if you don't push configure to do it from what I quickly saw in configure's, makefiles and m4 macros.)



---

archive/issue_events_120289.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-09T08:59:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13913#event-120289"
}
```



---

archive/issue_events_120290.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-09T08:59:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13913#event-120290"
}
```



---

archive/issue_comments_166934.json:
```json
{
    "body": "<a id='comment:15'></a>\noptional spkg is updated!",
    "created_at": "2013-01-09T14:35:34Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166934",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:15'></a>
optional spkg is updated!



---

archive/issue_comments_166935.json:
```json
{
    "body": "<a id='comment:16'></a>\nCannot locate the spkg on sage website or on mirrors.",
    "created_at": "2013-02-12T21:50:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13913",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13913#issuecomment-166935",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:16'></a>
Cannot locate the spkg on sage website or on mirrors.
