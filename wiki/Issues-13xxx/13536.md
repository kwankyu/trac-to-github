# Issue 13536: Password recovery doesn't work in the new flask notebook

archive/issues_013332.json:
```json
{
    "body": "When you try to recover a forgotten password in the new notebook, you are asked for the username, and then get the response \"invalid username\" even if the username is valid, and the email has been confirmed.\n\n**Assignee:** @jasongrout, @qed777, @williamstein\n\n**Keywords:** notebook authentication\n\n**Upstream:** Completely fixed; Fix reported upstream\n\n**Reviewer:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/13536\n\n",
    "closed_at": "2014-02-26T13:39:45Z",
    "created_at": "2012-09-26T12:53:23Z",
    "labels": [
        "component: notebook",
        "bug",
        "invalid"
    ],
    "title": "Password recovery doesn't work in the new flask notebook",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13536",
    "user": "https://github.com/miguelmarco"
}
```
When you try to recover a forgotten password in the new notebook, you are asked for the username, and then get the response "invalid username" even if the username is valid, and the email has been confirmed.

**Assignee:** @jasongrout, @qed777, @williamstein

**Keywords:** notebook authentication

**Upstream:** Completely fixed; Fix reported upstream

**Reviewer:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/13536





---

archive/attachments_018959.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13536.patch",
    "asset_url": "tarball://root/attachments/ticket13536/trac_13536.patch",
    "created_at": "2012-09-26T12:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13536/trac_13536.patch",
    "user": "https://github.com/miguelmarco"
}
```



---

archive/issue_comments_160335.json:
```json
{
    "body": "**Attachment:** [trac_13536.patch](https://github.com/sagemath/sage/files/ticket13536/trac_13536.patch)",
    "created_at": "2012-09-26T12:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160335",
    "user": "https://github.com/miguelmarco"
}
```

**Attachment:** [trac_13536.patch](https://github.com/sagemath/sage/files/ticket13536/trac_13536.patch)



---

archive/issue_comments_160336.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think this is fixed upstream.  See [the upstream master](https://github.com/sagemath/sagenb/blob/master/flask_version/authentication.py#L290).",
    "created_at": "2012-09-28T01:45:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160336",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>
I think this is fixed upstream.  See [the upstream master](https://github.com/sagemath/sagenb/blob/master/flask_version/authentication.py#L290).



---

archive/issue_events_115878.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T01:45:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115878"
}
```



---

archive/issue_comments_160337.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2012-09-28T01:45:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160337",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_comments_160338.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis is in fact already in #13121 and so this is invalid.",
    "created_at": "2012-09-28T01:49:52Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160338",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>
This is in fact already in #13121 and so this is invalid.



---

archive/issue_events_115879.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T01:49:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115879"
}
```



---

archive/issue_comments_160339.json:
```json
{
    "body": "**Upstream:** Fixed upstream, in a later stable release.",
    "created_at": "2012-09-28T01:49:52Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160339",
    "user": "https://github.com/kcrisman"
}
```

**Upstream:** Fixed upstream, in a later stable release.



---

archive/issue_events_115880.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T01:49:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115880"
}
```



---

archive/issue_events_115881.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T01:49:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115881"
}
```



---

archive/issue_comments_160340.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [@kcrisman](#comment%3A1):\n> I think this is fixed upstream.  See [the upstream master](https://github.com/sagemath/sagenb/blob/master/flask_version/authentication.py#L290).\n\nUpstream is still broken.The line that you point (and other lines that make things not work) coincide with the current version included in sage 5.3",
    "created_at": "2012-09-28T08:38:18Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160340",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:3'></a>
Replying to [@kcrisman](#comment%3A1):
> I think this is fixed upstream.  See [the upstream master](https://github.com/sagemath/sagenb/blob/master/flask_version/authentication.py#L290).

Upstream is still broken.The line that you point (and other lines that make things not work) coincide with the current version included in sage 5.3



---

archive/issue_events_115882.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T13:02:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115882"
}
```



---

archive/issue_comments_160341.json:
```json
{
    "body": "<a id='comment:4'></a>\nOops, you're right - I read the patch backward!\n\nHowever, this is a pretty easy thing to make a pull request for.  It turns out you can even do it more or less anonymously by clicking on the code itself and changing it... I'll try later this morning if I find time.",
    "created_at": "2012-09-28T13:02:51Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160341",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Oops, you're right - I read the patch backward!

However, this is a pretty easy thing to make a pull request for.  It turns out you can even do it more or less anonymously by clicking on the code itself and changing it... I'll try later this morning if I find time.



---

archive/issue_events_115883.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T13:02:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115883"
}
```



---

archive/issue_events_115884.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T13:02:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115884"
}
```



---

archive/issue_comments_160342.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman\" to \"\".",
    "created_at": "2012-09-28T13:02:51Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160342",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Karl-Dieter Crisman" to "".



---

archive/issue_comments_160343.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, in a later stable release.\" to \"Not yet reported upstream; Will do shortly.\".",
    "created_at": "2012-09-28T13:02:59Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160343",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Fixed upstream, in a later stable release." to "Not yet reported upstream; Will do shortly.".



---

archive/issue_comments_160344.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis is now [https://github.com/sagemath/sagenb/pull/99](https://github.com/sagemath/sagenb/pull/99).",
    "created_at": "2012-09-28T14:45:30Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160344",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
This is now [https://github.com/sagemath/sagenb/pull/99](https://github.com/sagemath/sagenb/pull/99).



---

archive/issue_comments_160345.json:
```json
{
    "body": "**Changing upstream** from \"Not yet reported upstream; Will do shortly.\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2012-09-28T14:45:30Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160345",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Not yet reported upstream; Will do shortly." to "Reported upstream. No feedback yet.".



---

archive/issue_events_115885.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T14:45:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115885"
}
```



---

archive/issue_events_115886.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T14:45:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115886"
}
```



---

archive/issue_comments_160346.json:
```json
{
    "body": "<a id='comment:7'></a>\nI prefer sagenb-only tickets such as this should be on sagenb github and only there. Even if this patch is positively reviewed, there is nothing I can do since sagenb has been separated from Sage. So, I would like to close this as \"invalid\" and refer to github instead.",
    "created_at": "2012-09-28T14:51:12Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160346",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I prefer sagenb-only tickets such as this should be on sagenb github and only there. Even if this patch is positively reviewed, there is nothing I can do since sagenb has been separated from Sage. So, I would like to close this as "invalid" and refer to github instead.



---

archive/issue_events_115887.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T14:51:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115887"
}
```



---

archive/issue_events_115888.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T14:51:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115888"
}
```



---

archive/issue_comments_160347.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2012-09-28T14:51:52Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160347",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_115889.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T14:51:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115889"
}
```



---

archive/issue_comments_160348.json:
```json
{
    "body": "<a id='comment:9'></a>\nHmm, I don't know about this.  We have tickets all the time for things in upstream packages.  Then we say \"fixed by spkg in #abcde\" and say \"close when #abcde is merged\".  Or sometimes even have an spkg right on the ticket.  Why should sagenb be any different?",
    "created_at": "2012-09-28T14:54:54Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160348",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
Hmm, I don't know about this.  We have tickets all the time for things in upstream packages.  Then we say "fixed by spkg in #abcde" and say "close when #abcde is merged".  Or sometimes even have an spkg right on the ticket.  Why should sagenb be any different?



---

archive/issue_events_115890.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T14:54:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115890"
}
```



---

archive/issue_events_115891.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-09-28T14:54:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115891"
}
```



---

archive/issue_comments_160349.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@kcrisman](#comment%3A9):\n> Hmm, I don't know about this.  We have tickets all the time for things in upstream packages.  Then we say \"fixed by spkg in #abcde\" and say \"close when #abcde is merged\".  Or sometimes even have an spkg right on the ticket.  Why should sagenb be any different?\n\nBecause we usually don't update sagenb *for every single ticket*.  Also, sagenb upstream is different because we don't patch the sagenb spkg in Sage.",
    "created_at": "2012-09-28T15:06:00Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160349",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Replying to [@kcrisman](#comment%3A9):
> Hmm, I don't know about this.  We have tickets all the time for things in upstream packages.  Then we say "fixed by spkg in #abcde" and say "close when #abcde is merged".  Or sometimes even have an spkg right on the ticket.  Why should sagenb be any different?

Because we usually don't update sagenb *for every single ticket*.  Also, sagenb upstream is different because we don't patch the sagenb spkg in Sage.



---

archive/issue_comments_160350.json:
```json
{
    "body": "<a id='comment:11'></a>\nI asked this question in github: I can't seem to get a \"forgot password\" link from the login page. Same problem is on sagenb.org. Where is this link that we are trying to fix here?",
    "created_at": "2012-09-30T02:09:43Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160350",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:11'></a>
I asked this question in github: I can't seem to get a "forgot password" link from the login page. Same problem is on sagenb.org. Where is this link that we are trying to fix here?



---

archive/issue_comments_160351.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2012-10-30T15:43:17Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160351",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_160352.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [@ppurka](#comment%3A11):\n> I asked this question in github: I can't seem to get a \"forgot password\" link from the login page. Same problem is on sagenb.org. Where is this link that we are trying to fix here?\n\nSee [the github pull request](https://github.com/sagemath/sagenb/pull/99), where Jason points out this only happens when we ask for an email address.  Anyway, it's been merged upstream in master, so now we just need to wait for a new sagenb package to make this ticket depend on!  \"Needs info\" for that (eventual) ticket.",
    "created_at": "2012-10-30T15:43:17Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160352",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Replying to [@ppurka](#comment%3A11):
> I asked this question in github: I can't seem to get a "forgot password" link from the login page. Same problem is on sagenb.org. Where is this link that we are trying to fix here?

See [the github pull request](https://github.com/sagemath/sagenb/pull/99), where Jason points out this only happens when we ask for an email address.  Anyway, it's been merged upstream in master, so now we just need to wait for a new sagenb package to make this ticket depend on!  "Needs info" for that (eventual) ticket.



---

archive/issue_comments_160353.json:
```json
{
    "body": "<a id='comment:13'></a>\nFix is part of sagenb since version 0.10.3. We are using version 0.10.8 (#15569). So let's get this ticket closed.",
    "created_at": "2014-02-23T23:18:29Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160353",
    "user": "https://github.com/a-andre"
}
```

<a id='comment:13'></a>
Fix is part of sagenb since version 0.10.3. We are using version 0.10.8 (#15569). So let's get this ticket closed.



---

archive/issue_events_115892.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2014-02-23T23:18:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115892"
}
```



---

archive/issue_events_115893.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2014-02-23T23:18:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115893"
}
```



---

archive/issue_comments_160354.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Completely fixed; Fix reported upstream\".",
    "created_at": "2014-02-24T07:28:03Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160354",
    "user": "https://github.com/ppurka"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Completely fixed; Fix reported upstream".



---

archive/issue_comments_160355.json:
```json
{
    "body": "<a id='comment:14'></a>\nJust set it to positive review, then close it as invalid.",
    "created_at": "2014-02-24T07:28:03Z",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13536#issuecomment-160355",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:14'></a>
Just set it to positive review, then close it as invalid.



---

archive/issue_events_115894.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2014-02-24T21:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115894"
}
```



---

archive/issue_events_115895.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2014-02-24T21:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115895"
}
```



---

archive/issue_events_115896.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-26T13:39:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115896"
}
```



---

archive/issue_events_115897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-26T13:39:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13536",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13536#event-115897"
}
```
