See also: https://trac.sagemath.org/ticket/30363